计算机应用
COMPUTER APPLICATIONS
1999年 第19卷 第10期 Vol.19 No.10 1999



一个基于图的多边形拓扑关系生成算法
周立新　严静　潘云鹤
　　摘　要　本文提出了一个基于图的多边形拓扑关系自动生成算法和实例。该算法只需利用图中弧与多边形的拓扑信息，避免了多边形内角的计算与比较，算法中根据图的拓扑特征采取有效的策略，加快了多边形自动生成的速度。
　　关键词　拓扑关系，多边形，GIS，弧
A GRAPH-BASED ALGORITHM FOR
GENERATING POLYGONS′ TOPOLOGICAL RELATIONSHIPS
Zhou Lixin　Yan Jing　Pan Yunhe
State Key Laboratory of CAD & CG, Zhejiang University， Zhejiang.Hangzhou 310027
　　Abstract　A graph-based algorithm for generating polygons′ topological relationships in GIS automatically is presented in this paper. The algorithm needs only a graph′s topological information, avoids computing and comparing the polygons′ interior angles. The algorithm speeds up the generation of polygons′ topological relationships by taking some effective measures according to the graph′s topological features. Finally, an actual example is also shown in the paper.
　　Keywords　Topological relationships, Polygon, GIS, Arc
1　引言
　　地理信息系统（GIS）是近年来发展迅速的一门边缘学科，GIS研究是国家科技发展计划中的重中之重项目。空间多边形拓扑关系的生成算法是GIS中的关键算法之一。
　　几何信息和拓扑信息是GIS中描述地理要素的空间位置和空间关系不可缺少的基本信息。地理空间信息的拓扑关系是GIS数据库的一项重要内容。利用拓扑关系可以确定点、线、面的空间关系及其属性，实现相关的查询与检索。
　　在原有的建立空间图形点、线、面的拓扑关系的算法中，采用几何信息与拓扑信息相结合，必须进行多边形内角的计算与比较，坐标位置的比较等，反复搜索，十分费时，而且还要进行一些例外情况的处理［3］。
　　本文所提出的算法只需利用空间要素的拓扑信息，不必进行多边形内角的计算与比较，并利用图的特征信息减少搜索工作量，从而大大加快了搜索的速度，并且没有例外情况需要处理。
2　基本概念
　　弧：　是由一系列的短线段首尾相连而成的折线，其中的转折点(X、Y坐标对)为弧的顶点，定义了弧的形状，弧的结束点叫做终结点，每一条弧有两个终结点：起始点和末端点，弧仅能在它们的终结点相连。弧是基本的存贮单位。
　　多边形：　是由一系列的弧在终结点相连而组成的封闭区域。一列弧被存贮用来组成多边形。虽然一条弧可能在一个或几个多边形的列表中出现，但是每一条弧只存贮一次。对每一条弧只存贮一次减少了存贮总量，并且保证了相邻多边形的边界不会重叠。
　　多边形的最小性：　对一个多边形，其内部不再有任何支链，如果从多边形的任一边出发，沿顺时钟或逆时针循游该多边形会发现，如果确定了基准角度，则构成多边形的相邻的弧的夹角必是最小的，这一性质称为多边形的最小性。具有最小性的多边形我们称为最小多边形。
　　结点的度：　在一个结点相连的弧段数。
　　弧的连接次数：　由于一条弧为相邻的多边形所共有，而且最多只能为二个最小多边形所共有，如果一条弧与其他弧组成一个最小多边形，则此弧的连接次数加一，若已组成二个最小多边形，则为二。
　　地图在数字化或经过矢量化软件自动识别后，经过数据预处理得到以下的原始数据：每一条弧的顶点坐标及终结点坐标，弧与弧的连接点，每一个多边形有一个标识点(为多边形的内点)及标识号。这些数据可以分别用弧-结点表、弧坐标表、弧的邻接表、多边形标识表、多边形-弧表等表格表示。
　　我们可以将点、弧段、多边形组成的图形看成为一个连通图，这里要提出的算法是从图的拓扑信息即弧与弧的邻接关系（以弧-结点表、弧的邻接表表示）自动生成所有的最小多边形，从而建立多边形的拓扑关系，至于由多边形的标识点生成弧的左右邻接表的算法，这里不予讨论。
3　算法描述
第一步 任取一边界结点为始点，成为当前结点；
第二步 对当前结点进行扩展，选取一与其相连并且在当前结点处没有被扩展的结点，
CASE 1：若相连结点在其他结点处没有被扩展过，则作为当前结点的次级结点，检查与当前结点相连的结点，
IF所有相连结点都已扩展
THEN 转第五步；
ELSE 转第二步；
CASE 2：若相连结点在其他结点处已被扩展过，则形成一个多边形，转第三步；
第三步 搜索组成最小多边形：从当前结点出发，置队列Q1为空，
LOOP：
IF 有同级结点相连且相应弧的连接次数小于2
THEN 沿相连弧段前进一步并将相连结点P加入队列Q1；
ELSE IF 有次级结点相连且相应弧的连接次数小于2 THEN 沿相连弧段前进一步并将相连结点P加入队列Q1；
ELSE 向上一级结点(相应弧的连接次数小于2)回溯一步，并将相连结点P加入队列Q1；
ENDIF
ENDIF
将结点P与Q1中的每一已有结点(起始结点除外)进行比较，
IF 结点P与Q1中的结点P1间存在相连的弧
THEN 将P与P1间的结点从Q1中去掉(保证多边形的最小性) ；
ENDIF
IF 结点P为起始结点
THEN 搜索得到一个多边形，转第四步；
ELSE 转向LOOP；
ENDIF
第四步 每得到一个多边形，将其组成的弧记录下来，并给一个多边形的编号，同时将组成多边形的弧的连接次数加一；
检查与当前结点相连的结点，
IF 所有相连结点都已被扩展
THEN 转第五步；
ELSE 转第二步；
ENDIF
第五步 当前结点扩展完毕，
IF 存在没有被扩展的同级结点
THEN 选取一同级结点为当前结点，转第二步；
ELSE IF 存在没有被扩展的次级结点 THEN 选取一次级结点为当前结点，转第二步；
ELSE 转第六步；
ENDIF
ENDIF
第六步 所有弧段的连接次数为2 ，搜索结束。
4　算法分析
4.1　已有的算法概述
　　如图1所示，搜索组成多边形2的弧，若当前结点为结点2，要搜索决定下一个组成多边形2的结点时，由于在结点2 处有弧c3、弧c5两条弧与结点2相连，首先必须计算弧c3、弧c5的方位角，再分别计算它们与弧c2的夹角，取夹角最小者为下一段组成多边形的弧c5，得到下一个结点7。依次类推，搜索得到组成多边形2的所有弧及结点。这样，才可得到所有最小多边形，建立多边形拓扑关系。在每一个结点处，若结点的度为m，则在这一算法中，必须进行如下计算：利用公式
ψ=arctg［(y2-y1)/(x2-x1)］
计算m次反正切；作m(m+1)/2次角度的比较。

图1
4.2　算法的分析
　　在本文的算法中，只要用图的拓扑信息来自动生成多边形的拓扑关系，不必进行多边形内角的计算与比较；算法的主要计算工作量在第三步，由于在搜索时采取同级结点、次级结点、上级结点的优先次序，平均在每一个结点处只需进行m(m+1)/2次弧的搜索比较。
4.3　比较分析
　　由以上的分析可知，本文所提出的算法的计算量大大小于原来的算法，经验证，在建立多边形的拓扑关系时，可提高效率一倍左右。
5　实例
　　如图1所示的图中，已得到各弧段的顶点坐标、结点坐标，结点编码、弧段编码、多边形标识码如图所示。弧的邻接表、弧-结点表如表1、表2所示。
表1　弧的邻接表
结点相连的弧
11,2,4
22,3,5
34,6,7
43,10,14
51,6,11
67,8,12
......

表2　弧-结点表
弧号起始结点终止结点
115
212
324
413
527
.........
.........

　　算法步骤：
　　首先选取结点1为始点，作为当前结点进行扩展，依次扩展到结点5、3、2，然后在选取结点5作为当前结点进行扩展 ...... 结点1为1级结点，5、3、2为2级结点 ...... 扩展次序为结点1、5、3、2、9、6、7、4、10、8,如图2所示。

图2
　　得到的多边形拓扑结构如表3所示。
表3　多边形-弧表

多边形号组成多边形的弧
11,4,6
22,4,7,8,9,5
33,5,10
46,7,11,12
58, 12,15,13
69,13,14,10


6　结论
　　此算法仅用图的拓扑信息来自动生成多边形的拓扑关系，避免了进行多边形内角的计算与比较；使用同级结点优先搜索与只对弧的连接次数小于2的弧搜索的策略，避免了对图中弧段的邻接关系表的反复搜索，减小了搜索回溯深度，减小了为保证多边形的最小性而进行比较的次数；从而使多边形拓扑关系自动生成的速度大大加快，而且算法保证了多边形的最小性，保证了搜索出所有符合条件的多边形，使算法具有完备性。该算法中没有例外情况需要处理。
　　由于多边形拓扑关系的生成算法是地理信息系统中的一个关键算法，从而，这一算法具有重大的实用价值。
注：本文属国家863计划智能计算机主题支持课题。
作者简介：周立新　博士研究生。主要研究领域为CAD/CAM、计算机图形学、地理信息系统。
严静　助理工程师。主要研究领域为计算机图形学、电子线路设计。
潘云鹤　教授，博士生导师。主要研究领域为人工智能、计算机图形学、空间推理、计算机美术。
作者单位：浙江大学CAD & CG国家重点实验室　浙江.杭州（310027)
参考文献
［1］　唐治锋，等. KCPIS的空间数据模型与用户界面. 测绘学报，1996；25(1):63-66
［2］　李　霖，李德仁. GIS中二维空间目标的非原子性和尺度性. 测绘学报， 1994；23(3):315-321
［3］　崔伟宏. 空间数据结构研究. 科学出版社，1995，11
［4］　龚建雅. 整体SIS的数据组织与处理方法. 武汉测绘科技大学出版社，1993
［5］　江泽涵. 拓扑引论. 科学出版社，1981
［6］　罗杰斯．D．F. 计算机图形学的算法基础. 科学出版社，1987
［7］　Hanan Samet. Application of Spatial Data Structures. ADDISON-WESLEY PUBLISHING COMPANY, 1990
收稿日期:1999-06-20(修改稿)
