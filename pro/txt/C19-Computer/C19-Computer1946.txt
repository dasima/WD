微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
1999年 第18卷 第1期 Vol.18 No.1 1999



系统功能授权控制
徐东平
　　摘　要：事务处理系统中多级口令控制及功能授权控制的实现原理，实现系统功能授权控制所需的数据表示和基本功能，并用VFP 5.0支持语言和SQL描述了控制思想。
　　关键词：数据库　管理信息系统　授权控制
　　1个庞大的事务处理系统，包含着多种职能部门的多种业务活动，各种业务活动常需要相应的信息保护措施。这些系统往往是在分布式数据库及网络集成环境下实现的。为便于业务人员交流及用户在不同工作站上进入系统，可以采用系统功能授权控制方式，使不同的职能部门或工作团体仅能进入自己享有访问权的系统功能，这对于保证系统安全极为重要。
　　用户使用自己的口令登录，系统按用户权限，“允许”部分功能，“禁止”其它功能。不同用户对应不同口令级别，口令级别可分为：①系统级。即享有所有功能使用权限，可修改所有团体口令、个人口令、授权及其它全部功能。②团体级。可具有自己团体口令修改功能，接纳本团体用户，被授予其它功能。③一般级。享有被授予的功能，这些功能中不能享有自己团体口令修改功能及接纳本团体用户功能。
1　数据描述及基本功能
　　以VFP 5.0集成环境为例，用VFP 5.0语言作前台开发语言，采用按口令控制进入用户享有功能实现思想，此思想可支持建立在WINDOWS NT4.0环境下，由SQL SERVER 6.5或其它大型数据库管理系统作后台数据库管理的事务处理系统，也可支持单机环境下的事务处理系统。
　　在VFP 5.0菜单定义语句中，有一可选子句“SKIP FOR<逻辑表达式>”，当此逻辑表达式为真时，该菜单定义项便被忽略。若菜单项被忽略，在屏幕上见到的现象是相应菜单项被暗化，不能被选择。
　　在集成开发环境(IDE)的菜单设计器中，可以用鼠标左键点击“OPTION”，并在随后出现的对话框“SKIP FOR”选项中输入逻辑表达式，此逻辑表达式控制着菜单中相应选项的有效性。
　　基于以上子句功能，可以令每一菜单功能d(i)项对应1个逻辑变量contrx(i)。当用户登录，即系统获得用户口令时，便将用户允许进入的功能所对应的菜单项中的逻辑变量contrx置成“假”，其余的contrx置成“真”。
　　要实现上述控制，需要如下信息：
　　1.表F记载团体名称f与其口令p，系统管理员可设置F，F满足：
　　F={f｜f是1组人员，或者是1个职能部门，f唯一拥有口令P}
　　图1为F的关系，*f是F中的关键字。

图1　F的关系描述
　　2.表fr记载团体f及其包含的成员或成员口令r，系统管理员及职能部门负责人可设置fr，fr满足：
　　f={r｜r是f的成员或成员口令}
　　图2为fr的关系，*f与*r是fr中的复合关键字。

图2　fr的关系描述
　　3.表fd记载团体f可享有功能d，系统管理员可设置fd，fd满足：
　　fd={d｜d∈(系统全部功能)，f可享有d}
　　图3为fd的关系。*f与*d是fd中的复合关键字。

图3　fd的关系的描述
　　4.表fc记载超级口令p,p唯一存在，但也可看成是图4所示的关系。

图4　fc的关系描述
　　以上关系也可用实体关系模型图(E-R图)描述，见图5。

图5　实体关系模型图
　　系统中应该包括下列与系统安全有关的功能：
　　1.设置自己团体口令功能d1：显示本团体名及口令，并可修改口令。
　　2.向自己团体增加用户功能d2：显示本团体名及全体成员，并可修改或删除成员。
　　3.设置全部团体口令功能d3：显示全部团体名及其口令(包括超级口令)，并可修改或删除团体。
　　4.给任一团体增加用户功能d4：显示全部团体名及所有成员名，并可删、改。
　　5.给团体授权功能d5：给任一团体指定可进入功能。
2　控制思想
　　采用团体口令P(包括超级口令)或一般用户口令R登录后，相应用户享有功能确定，可用下面的子程序subp描述：
　　求p=P享有功能：
　　select fd.d from fd,F where F.p=P and F.f=fd.f and(p not in(select p from fc)and not inlist(d,`d3',`d4',‘d5')or p in (select p from fc))into cursor temfoun1 varfoun1=tally
　　即：持有口令P的用户享有varfoun1个功能，这些功能暂存在内存文件temfounl中。
　　求r=R享有功能：
dimention x(2)
select distinct fr.f from fr where fr.r=R into carry x
select fd.d from fd,F where F.f=x(1)and F.f=fd.f and notinlist(d,`d1',`d2',`d3',`d4',`d5')intocursor temfoun2
varfoun2=－tally
　　即：持有口令R的用户享有varfoun2个功能，这些功能暂存在内存文件temfoun2中。
　　为实现菜单项控制，系统中可建立表SYS，SYS中建立控制数组元素c与系统功能d对应关系如图6。

图6　数组元素c与系统功能d的对应关系
　　设系统包含总功能数为MAXF，控制菜单项程序代码如下：
　　　　do subp
　　for i=1 to MAXF
　　　　contrx(i)=.t.
　　endfor
　　if varfoun1>0
　　　select c from sys where d in(select d from temfoun1)into cursor temfoun3
　　else
　　　select c from sys where d in(select d from temfoun2)into cursor temfoun3
　　endif
　　scan
　　　vartem=c+‘=.f.'
　　　&vartem
　　endscan
3　功能保护强度
　　上述功能保护强度，取决于系统中口令的保密强度。根据以上数据说明可知，多级口令全在表中。为提高口令的保密强度，可以将表F中各元组的p属性值、表fr中各元组的r属性值采用密文存放，在控制菜单项程序代码中，将其转为明码在内存临时表中保存，然后采用上述控制程序。关于明文与密文间的变换问题，本文不作详细讨论。
作者单位：武汉交通科技大学计算机系(430063)
参考文献
　1　Microsoft.SQL SERVER 6.5管理员指南.北京：科学出版社，龙门书局，1997
　2　运通创作室.Visual FoxPro 3.0语言实用详解.北京：学苑出版社，1997
(收稿日期：1998-06-25)
