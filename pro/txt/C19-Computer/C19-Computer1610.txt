信息与控制
Information and Control
1999年　第28卷　第5期　Vol.28　No.5　1999



神经元自适应预测PID控制器及实现

杨　智　高　靖

　　摘　要：采用单神经元构成PID控制器，并和预测控制 结合克服时滞对控制系统的影响．对大时滞大惯性的电加热炉的实时控制结果表明，这种自 适应控制算法切实可行，且具有较强的鲁棒性，适合于控制大时滞被控过程． 
　　关键词：神经元，最优预测，PID，时滞系统，工控机
　　中图分类号：TP13　　　　　　文献标识码：B

AN ADAPTIVE NEURON PID CONTROLLER WITH OPTIMAL
PREDICTIVE AND ITS REALIZATION
YANG Zhi GAO Jing
(Dept. of Electrical and information engineering, Gansu Univ. of Tech.,Lanzhou 730050)
Abstract: In this paper, an adaptive neuron PID controller wi th optimal prediction which is suitable for the process with unknown time-varyi ng delay, disturbance and time-varying parameters is presented. The control alg orithm combined intelligent control with predictive control. The real-time temp erature control result of the electrical furnace shows that the presented adapti ve neuron PID controller with optimal prediction may be realized and has high ro bustness, especially for the delay systems. 
Key words: neuron，adaptive control，predictive control，PID，de lay systems，industrial process computer

1　引言
　　常规的PID调节器是一种应用十分广泛且比较成熟的控制算法，对于受控对象结构和参数 已知的场合，可获得较好的控制效果．但对于工业过程中常见的慢时变大时滞控制系统，由 于时滞变化可能会使系统不稳定，常规的PID调节器不能获得良好的控制品质．神经元自适 应预测PID控制算法利用模型加权函数的误差函数确定时滞，然后与预测控制的超前预测功 能结合，起到克服时变时滞的作用，并利用神经元构成PID控制器实现参数自适应．这种自 适应控制算法适合控制有扰动，参数时变尤其时滞时变的大时滞被控过程．对大时滞大惯性 的电加热炉的实时控制表明，提出的神经元自适应预测PID控制器切实可行，可以构成较 实用的工程控制器．
2　神经元自适应预测PID控制算法 
　　神经元自适应预测PID控制系统结构图如图1所示．

图1 神经元自适应预测PID控制系统结构图

2.1 时滞的辨识
　　假设被控过程的动态特性可用下列差分方程表示
A(z-1)y(k)=B(z-1)u(k-d-1)+C(z-1)ε(k)　　　　　　　　　　(1)
其中,A(z-1)=1+a1z-1+…+anz-n；B(z-1)=b1+b2z -1+…+bnz-n+1, b1≠0；C(z-1) =1+c1z-1+…+cnz-n ;u(k)、y(k)分别是过程的控制和输出序列；ε(k)是环境干扰，为随机变量；是输出对输入 响应的时滞时间，是过程的阶次．
作者在文[2]中，用一个修正的广义模型重写式(1)，得
A(z-1)y(k)=B*(z-1)u(k)　　　　　　　　　　　　　　(2)
其中，B*(z-1)=bn1z-1+…+bnn+dmaxz-(n+dma x)；dmax是过程时滞时间的上限，并预先可知，且0≤d≤dmax -1，则存在下列方程
b*i=0, i=1,…,d; bnj=bj-d, j=1+d,…,n+d
b*l=0, l=n+1+d,…,n+dmax
用递推的最小二乘法对修正的广义模型进行参数估计，有

X=[-y(k-1), …,-y(k-n); u(k-1), … ,u(k-n-dmax)]
当k→∞时，*i和*l→0，对于确定的k，*i、* l为一较小的值．辨识出*(z-1)的系数后，就可计算误差函数
F(d)=|*(1)-*d(1)|　　　　　　　　　　　　　(3)
其中，*(1)=∑*j, i=1,…,n+dmax;
当F(d)为最小时，对应的d就是时滞时间．
2.2 最优预测的设计
由Diophantine方程
C(z-1)=A(z-1)F(z-1)+z-d-1G(z-1)　　　　　　　　　　　(4)
其中，F(z-1)=1+f1z-1+…+fdz-d;G(z-1)=g0+g1z -1+…+gn-1z-n+1．
由式(1)和式(4)可得
　　(5)
以(k+d|k-1)表示根据k-1时刻输入输出值对k+d时刻输出量y(k+d)的预测值，可以找到一个最优d步预测*(k+d|k-1)使预测方差最小，即满足下式
E{y(k+d)-*(k+d|k-1)}2≤E{y(k+d)-(k+d|k-1)}2　　　　　　　　　(6)
式中E(.)表示均值．将式(5)代入式(6)，可得最优预测为
　　　　　(7)
2.3 克服时滞的理论分析
　　控制器按PID控制器设计，有
{yr-y*[k+d|k-1]}P(z-1)=R(z-1)u(k)　　　　　　　　　　　　(8)
其中，P(z-1)=p0+p1z-1+p2z-2; R(z-1)=1-z-1. 由式(1)、式(7)和式(8)可得最优预测PID控制系统的输出为
　(9)
若使用常规的PID控制器，系统的输出为
　　　　　　(10) 
由式(9)看出，最优预测PID控制系统的闭环特征方程中已经没有时滞项，即整个控制系 统已消除了时滞对系统品质的影响，而常规PID控制系统式(10)的特征方程中仍有时滞项．
2．4 神经元自适应预测PID控制器
用梯度最小法极小化目标函数，得权值调整方程为
　　　　　　　　　(11)
其中，ηi为学习步长，目标函数取为： 
　　　　　　　　　　　(12)
式中，yr为期望的设定值，yn(k+d)为被控过程输出的d拍超前最优预测，d为时滞时间．
　　神经元的输出为
　　　　　　　　　(13)
其中，kv为神经元放大系数，xi(k)为神经元输入，取
x1(k)=e(k)-e(k-1)　　　　　　　　　　　　　　　　　　　
x2(k)=e(k)　　　　　 　　　　　　　　　　　　　　　　　
x3(k)=e(k)-2e(k-1)+e(k-2)　　　　　　　　　　　　　(14)
其中，e(k)为最优预测值形成的反馈偏差，用被控过程未来的最优状态来控制其当前行为，提高控制决策的智能性及控制系统的动态品质，减小时滞对系统稳定性的影响． 
e(k)=yr-y*(k+d)　　　　　　　　　　　　　　　　　(15)
而，
　　　　　　
　　　　　　　　　(16)
可最终得出权值的修正公式为
(17)
其中，神经元放大系数kv的在线调整公式取为
kv(k)=kv0+α[yr-y*(k+d)]3/y2r　　　　　　　　　　　　　　(18)
式中，kv0为kv的稳态值，α为调整系数,一般取kv0的十分之一．该变换使偏差较大时kv也较大，增加响应速度；偏差较小时，kv近似为kv0，减小超调量 ．
　　kv值的在线调整使得ηi对控制特性的影响甚微，几乎不予考虑．
3　神经元自适应预测PID控制器在电加热炉上的应用
　　电加热炉温度控制系统的硬件电路如图2所示．

图2 硬件电路图
　　IPC-610工控机及GENIE3.0软件包是台湾研华公司生产的标准PC平台上的工控机及组态软件．其特点是成本低、易掌握及功能强大．GENIE3.0运行于Windows环境下，它的实时性能好，有丰富的图形用户界面，使用基于任务扫描的执行方式．任务设计器使用工具箱，大大简化了过程控制和数据采集．A/D、D/O转换分别采用研华公司生产的PCL -818L、PCL-726电路板，PCLD-789D是热电偶输入模板，它完成热电偶的冷端补偿及温 度信号的放大与转换．
　　根据控制系统要求，电阻炉的温度通过K型热电偶采集，进入PCLD-789D放大与冷端补偿后，送入PCL-818L完成A/D转换，将信号送给主机后完成控制算法得出控制量，经PCL-726完成D/O转换后输出给端子板，控制固态继电器的通断．由于GENIE3.0自带有一套动 态连接库驱动程序，所以无需为外围电路编写驱动程序．
　　GENIE的运行方式是一种基于扫描的多任务执行方式，编程器使用类似于VB的编程语言，本温度控制的软件设计部分由四个模块组成，任务特性如表1.
表1 任务特性表

　功能运行时间执行方式运行周期
TASK1辨识、预测PID控制、滤波永远立即5 S
TASK2占空比控制　命令式100ms
TASK3初始化一次立即
TASK4报警永远立即100ms

　

各模块中，利用提供的虚拟标识来记录各次控制量，它的值存在数据中心内，具有全局 性和开放性．
　　实时控制时，为了防止kv0设置过大而达不到稳态值或人为产生输出振荡，k v0的设置应从百分位开始．当输出超调过大，应适当减小kv0；当输出跟踪不上设 定值，应适当增大kv0；若控制量u(k)持续增长直到上限值，说明kv0设置太大 ，应大幅度降低；若控制量u(k)变化甚微，以至于输出值持续缓慢增长或缓慢降低，说明k v0设置太小而使神经元失去了自学习能力，应大幅度的增大kv0．
　　当采样周期取25s，设定值80℃，取kv0=0.0011，在5个小时内的炉温输出曲线如图3所示．当权值已趋于稳态值，控制量已基本不变时，炉温输出有0.7℃以内的正偏 差，-1.2℃以内的负偏差，满足控制精度要求．

图3 神经元自适应预测PID控制器温度
　　图4为图3的控制量曲线．若在75℃以前采用纯比例控制，在75℃时切换为提出的新算法 ，如图5所示控制超调小，偏差在±0.6℃以内，控制效果更佳．
　　　　　
　　　　图4 控制量曲线 　　　　　　　　　　　图5 改进初始控制策略的温度实时控制结果
4　结论
　　提出的神经元自适应预测PID控制器，能够提高控制系统的自适应能力和鲁棒性，克服了被控过程的时滞．该控制器结构简单，易于实现，只要设置合适的kv0值，即可得到满意的控制效果．
注释：清华大学智能技术与系统国家重点资助项目；甘肃省自然科学基金资助项目；
作者简介:　杨　智，男，37岁，教授．研究领域为过程控制，智能控制及大时滞系统的稳定性及控制 策略等．
　　　　　　高　靖，女，25岁，硕士生．研究领域为过程控制，智能控制等．
作者单位：甘肃工业大学电气与信息工程系　兰州　730050
参考文献
1　Lui Xiyuan, Mansur M. Stability Analysis and Stability Condition in the Delay Intervals for Second-Order Delay System. INT.J.Control,1984,4 0(2): 317～327
2　刘希远,杨 智,陈铁军,钟 春. 时变大时滞极点配置最优预报自校正PID控制器.控制与决策,1990,5(5):19～23
3　杨 智,刘希远. 时变分数时滞系统最优预报自校正极点配置PID控制算法.控制理论与应 用,1992,9(3):292～295
收稿日期：1998-11-09
