计算机工程
COMPUTER ENGINEERING
1999年  第25卷 第7期 Vol.25 No.5 1999



虚拟现实在CAD/CAM中的应用
陈正鸣 吴玉光 范永法
摘要 简述了虚拟现实（VR）在CAD中应用的产生背景、意义；介绍了目前研究的基本状况及其基本概念和基本内容；综述了当前的一些主要方法和关健技术；分析了目前存在的一些主要问题。最后展望了该研究领域的发展趋势。
关键词 虚拟现实 计算机铺助设计/计算机铺助制造 虚拟装配
Virtual Reality in CAD/CAM
Cheng Zhengming Wu Yuguang Fan Yongfa
Hehai University Changzhou 213022
Abstract：Virtual reality ahs only recently matured enough to warrant serious engineering applications.The integration of this new technology with software systems for engineering,design,and manufacturing will provide a new boost to the field of CAD.This paper presents some basic concdpts,main idea,some methods and key technologies forVRin CAD/CAM,and their application and future work are discussed.
Key words：Virtual reality；CAD/CAM；Virtual Assembly
　　随着实体/曲面造型技术、特征技术以及计算机硬件设备的发展，CAD/CAM飞速发展。大量商品化的CAD/CAM软件走向各个领域。然而，与此不相匹配的是，直到今天，用户与CAD/CAM系统的交互手段几乎没有改变，还是采用标准的键盘／鼠标输入。用二维的界面来处理三维的造型环境，缺乏三维的交互设备，因而也就缺乏直观性。这样促使人们寻求新的方法来解决人机交互问题。近年来VR技术的产生和发展，使得越来越多的人们采用VR的三维交互设备来改进CAD/CAM的人机交互界面，进而产生了基于VR的CAD/CAM研究领域。 
(1) VR 技术简介
　　VR是虚拟现实的简称，是指给人以身临其境的现实感觉的虚拟环境。一般是指由计算机生成的虚拟环境。通常VR由硬件设备和软件系统两部分组成。主要硬件设备有： 
　　头盔显示器(Helmet-mounted Display)；跟踪设备，典型的有电磁传感器，依附于人的身体上以使计算机能跟踪人的运动，如数据手套和衣服等；触觉器与运动反馈设备；三维鼠标、耳机、立体声设备等。 
　　主要的软件工具有图形开发系统、语言识别系统等。这些软件、硬件本身也在不断地改进完善过程中。
(2)  两类基于VR的CAD设计系统
　　基于VR的CAD设计系统主要可分为两大类，一类是增强的显示系统，一类是VR－CAD设计系统。
　　・增强的显示系统 : 在这种类型中，物体模型由现有的CAD系统生成。通过适当的变换处理，把物体模型输入到VR环境。一旦物体输入到VR环境，通过三维交互设备和显示设备对物体模型进行检查，对物体进行操作。
　　. VR－CAD系统：这一类系统可使用户在VR环境下进行设计活动。这样的好处使得设计者在进行三维设计时突破传统二维设计界面。这类系统使用各种输入设备(如数据手套、三维导航设备等)给用户提供三维设计和交互界面。另外，还可用声音和手势进行交互输入。声音和手势输入形式是目前人机界面研究的一个重要部分。
(3)VR在CAD/CAM 中的应用是一个90年代出现的新领域。虽然许多国内外学者展开了不少研究工作。总体说来，研究工作还很初步。本文主要讨论VR在CAD/CAM中应用的几个方面的问题。将分别讨论其内容、一般方法、研究现状以及存在的一些主要问题。
1  利用VR技术支持概念设计
　　CAD系统的研究者们总是力图使CAD系统支持产品设计的全过程，尤其是支持产品的概念设计。有关研究表明，产品成本的60%－70％决定于概念设计阶段。然而传统的CAD系统支持概念设计方面是困难的。主要问题在于用户必须先确定产品的外形。几何尺寸等建立模型。而建模过程要做很多低级操作(如对点、线、面操作 )。这样，一个非专业CAD人员是无法使用的。要建立一个产品模型，必须由设计师和CAD人员共同协调完成。
　　为支持产品的概念设计，大量学者进行长期的努力。草图设计、参数化设计、基于特征的产品设计等技术都为支持概念设计提供了条件。而利用VR技术使得真正意义上的支持概念设计的CAD系统的产生成为可能，利用VR技术支持产品的概念设计主要解决以下几个问题：
(1) 产品的设计模式
　　产品的表示方式多种多样，其中常用的有两种：参数化设计和自由曲面设计。参数化设计主要用于生成立方体、圆柱体、球等标准几何形状。用户可以用高级命令通过确定参数来方便地生成。自由曲面可通过手的运动轨迹给出曲面的初步形状，而不用控制顶点方式来生成。 
(2) 产品形状生成的交互方式
　　用户生成一几何形状可用两种方式：隐式的和显式的。例如：生成一立方体。首先可发出声音命令"产生一个立方体"，然后说"长这样、宽这样、高这样"。而在说"这样"的同时用两手比画出一个长度，以确定立方体的初始尺寸，这样一个立方体就生成了。这里并不需要用严格的尺寸，因在概念设计阶段并不需要严格的尺寸。这就是隐式生成。显式生成可如下进行，发出声音命令"产生一个立方体，长为20mm，宽为10mm，高为5mm"。这时按照用户提供的尺寸生成长宽高分别为20mm、10mm、5mm的立方体。这样一种方式结合声音和手势来造型，既方便又清楚。对曲面造型更多地用隐式方式生成。
(3) 产品形状的修改
　　参数化方式下，产品形状的修改和生成的方法差不多。可通过声音和手势加入一个孔、槽，拉长一物体等，或重新确定尺寸。在自由曲面设计中，修改工作要困难一些，修改时要提供一套高级的抽象手段。如用材料类型、表面特征、虚拟工具来完成修改工作。 
2  虚拟环境下对物体的操作
　　在CAD/CAM系统中，经常要对物体进行各种的操作，如在基于特征的设计中加入、修改及删除，在装配设计中采用多种装配方案。鉴于VR的身临其境的特性，可对物体进行直接操作。人们自然会利用VR的优点来进行设计。然而在具体对物体操作时，会发现各种各样的问题。一个简单的例子，假如要布置一个房间，要放置许多椅子、桌子、灯具等。在VR下，可直接抓取物体，把它放在所需位置。但是，如果需在天花板上安装一盏灯，你虽可看到天花板，但又达不到。这就需要有相应的操作技术支持。又如放置椅子可以把椅子限制在地面上移动(二维运动)使得操作更精确。 
　　可见，在VR下对物体的操作有着它自己的特性。如果不充分了解这些特性，就很难在VR下对物体进行有效的操作。下面简述几种操作技术。
　　.AAAD－远距离操作(Action－At－A－Distance)
　　远距离操作时，可用一光速从手上(手套)发出选取一物体，然后移动手(把手运动映射到相应的物体运动)来操作物体。AAAD的一个限制是被选取的物体必须可见。所以当把AAAD和其他一些虚拟操作技术结合在一起将更为有效。同时AAAD是一个近似的操作手段(不能精确定位)。
　　.视角模式
视角模式是视点确定最直观的方法。在视角模式下，感兴趣的物体总是被限制在用户面前。物体的可见部分依用户的视线方向而定，抬头时看到物体的底部，低头时看到物体的顶部。这样可使用户快速自然地看到物体的各个侧面(只要稍微移动一下头)。在视角模式下，在视点确定的同时，用户的手可进行其他操作。视角模式对局部视点确定很有好处，但它不是一个全局的导航技术。
　　.WIM－微缩技术(World－In－Miniature) 
　　WIM把呈现在用户面前的虚拟世界以缩小的形式显示出来。在WIM下，用户可方便自然地选取和操作场景中的物体，可同时进行全局和局部操作。但WIM并不能解决对物体操作的精确定位。WIM和AAAD技术能使用户不必移动物体而与整个场景进行交互。
　　.菜单交互技术
　　在VR下，可借用二维菜单技术方便地对物体操作，但它比二维菜单更加灵活，菜单可在三维世界里任意飘移。当然也得注意菜单阻挡物体视线的问题。
　　.约束物体操作
　　目前在VR下对物体操作的主要缺陷是在交互操作时缺乏约束。这样，对物体的精确定位就很困难。在VR中对物体约束可分为两类：虚拟约束和物理约束。虚拟约束是在用户操作物体时忽略一些自由度，如对物体定位时，用户的手可在3个方向上任意移动，而物体被限制在一个平面上移动。物理约束是指在实际上用户操作物体时限制手的运动。
3  基于特征的CAD系统的VR界面
　　特征技术是CAD/CAM研究的热点之一。大部分现在流行的CAD系统都会有特征设计的功能。基于特征的设计开始于一个简单的体(如立方体、圆柱体等)，进而加入各种各样的特征，如孔、槽等。设计者确定这些特征的位置、大小和方向。最后，为了有效表示设计意图，要求系统中加入特征间的相互关系(特征约束)及特征内部元素的约束关系 。
　　基于特征的CAD系统往往有很复杂的用户界面。主要是三维特征的安置、约束关系的建立不容易。目前，许多CAD系统如 Pro-Engineer ，仅仅允许用户在面上设置约束。因此一个特征的确定，先要依附在部件的一个选定面上，再确定与这个面相关的方向。一旦设计者把一个特征依附到部件的内部隐藏面上，用户就不得不列数许多面来选择需要的面。这些系统的另外一个不足是不能检查特征的可加工性，很少能提供按顺序制造特征的工艺规划的指导。把VR技术和特征技术结合在一起，为以上所提问题的解决提供了较好的方法。一个基于特征的VR系统界面比起传统的二维界面有以下优点：
　　.使设计过程更方便。基于特征的VR界面允许用户在部件附近导航，可进入其空腔内，可在指定的三维空间面上绘制特征。三维约束可方便地选择相关特征直观地建立起来。这样，用户可不间断地输入那些输入难度大(二维界面时)的特征和约束，使得设计者的思想和推理过程的连续性不会被中断。
　　.可简化实施特征可接近性约束。设计者直接在曲面操作，从而增加了设计的可制造性，保证了曲面的可接近性。设计者要求在增加特征以前必须先能达到其依附面，这非常像加工工具必须先到达某一曲面才能加工某一特征。
　　.能给工艺规划师提供关于特征顺序的提示。工艺规划的问题之一是决定各种特征的加工顺序。在VR界面下设计使得这些顺序信息可清楚地表示出来。设计者对特征次序的选择恰恰反应了 " 生成 " 某一零件的最方便的路经。
　　基于特征的CAD系统的VR界面的研究，有赖于特征技术的发展，同时也需解决VR下设计的一些固有困难，最直接的一个问题是物体干涉检测。在导航过程中，手是否碰到了物体、特征间是否相交。一般的检测方法会导致大量的计算。还有一个基本的问题是特征的表示和定义。
4  利用VR技术的虚拟装配
4.1  虚拟装配相关问题
　　虚拟装配 (Virtual Assembly) 简称VA，是VR在CAD/CAM中应用的一个重要领域。同时VA也是虚拟制造的关键部分。它可以这样来描述：利用计算机的工具，而不用建立一个产品的实际模型，通过分析、可视化、数据表示等技术帮助工程师进行装配关系的工程决策。VA的研究涉及到如下一些问题：
　　.装配模型   即VA系统如何精确表示产品的装配过程。
　　.零件装配和拆卸时，零件的运动轨迹及零件移动时扫描出来的扫描体的分析处理。
　　.装配工艺规划。如何把产品在VR系统中的装配描述映射到装配工艺中。
　　.碰撞检测问题。这是在装配过程中必须面对的问题，关键在于如何减少计算量。
　　.约束表示管理。装配件之间的关系可用约束关系来表示，要解决这些约束关系如何表示与处理。
　　在VA系统开发中，要解决以下一些相关的技术问题：
　　.虚拟空间的标尺，因用户在虚拟空间中有极大的自由度，故在虚拟空间中的定位、控制需有一定的标尺。
　　.图形显示速度。VR中图形显示的计算量大，实时显示的速度是一个重要的问题。
　　.轨道编辑。装配轨道可以很多，有一个优化的问题。
　　.虚拟装配的标准。
4.2  两个典型的VA系统
　　VA的研究工作开展得尚不多， Jayaram S等人开发了一个"虚拟装配设计系统"--VADE系统。 VADE是一个在VR下面向装配的设计系统。其大致的运行框架如图1。

图1 VADE系统
　　首先由CAD系统(如 Pro/Engineer)产生装配模型。零件的有关属性、几何信息自动提取。零件的公差、位置、方向及装配的零件集、装配约束一同提取提供给VADE系统。这样用户有了一个装配的"预规划"方法。进入VADE环境，用户可以进行装配设计。在装配过程中，用户可选择、生成、修改装配轨道或进行重装配。此时要进行碰撞检测。由VADE产生的信息可有多种用途。轨道信息、装配顺序信息等可输入到装配分析系统，允许工程师生成返回到CAD环境的提供设计修改的建议。
　　Gupta R等人提出了一个利用多模式虚拟环境的装配分 析设计原型方法。此方法不是用传统的基于表的装配方法，其目的是通过装配分析对装配方法进行评价，然后从多种方案中选择优者。为环境物体间及物体和用户提供动态触觉交互，建立一个物理模型。此模型利用听觉事件驱动来扩展 VADE( 面向装配设计的虚拟环境)的功能。通过触觉(用力反馈触觉设备)感觉到对物体的各种操作。因此模型是一物理模型，可考虑物体的重量、大小、外形、磨擦力等物理特征。此方法的基本框架如图2。

图2 多模式虚拟环境的装配分析设计原型方法
5 趋势与展望
　　虽然VR技术在1965年就被提出。但到80年代和90年代才有所发展，所以它还被认为是一项新的技术，每天都在不断变化和发展。现在，VR技术在CAD中的应用价值已被人们所认识。一些研究团体已开始把VR技术应用到CAD/CAM领域来。然而，VR技术在CAD中的大规模的使用尚待时日。它需要相关技术如实体造型、曲线 / 曲面造型、特征造型等的进一步成熟与发展，更需要相应硬件设备性能的提高和软件系统的开发。目前，利用VR技术支持CAD在工业界快速增长。 Caterpilter、General Motors、Boeing、Ford Motor及British Aerospace等大企业公司是利用VR技术支持设计、分析、制造的先驱。The Computer in Engineering Division of the American Society of Mechanical Engineers开创了一个称为"虚拟环境与系统"的新的技术领域，有每年一度的ASME国际会议。ISO标准委员会也在试图建立支持VR的相关标准。VR技术因其独有的特性，必将有力地促进CAD/CAM的集成，大大加快CAD/CAM的发展。
*本文受水利部科技基金项目资助
作者简介：陈正鸣 男，34岁，讲师，主要研究方向：计算机辅助设计与计算机图形学
作者单位：消费品海大学常州分校CAD/CAM 研究室 常州213022
参考文献
1 Jayaram S,Connacjer H I,Lyons K W. Virtual Assembly Using Virtual Reality Techniques.Computer-Aided Design, 1997, 29(8): 558
2 Gupta R,Whitney D,Zelter, D.Prototyping and Design for Assem- bly Analysis Using Multimodel Virtual Environments.Computer-Aided Design, 1997,29(8),585
3 Shah J J,Mantyla M.Parametric and Feature-Based CAD/CAM. Wiley and Sons Inc., New York,1995
收稿日期：1998-11-10
