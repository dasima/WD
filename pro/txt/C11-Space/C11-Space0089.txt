航空计测技术
AVIATION METROLOGY &MEASUREMENT TEHNOLOGY
1999年　第19卷　第4期　Vol.19　No.4　1999



冲击测量系统Ⅲ的硬软件实现方法
焦仁民
1　问题的提出
　　使用JJG498―87对凸轮式碰撞试验台进行检定时要求所使用的仪器有过渡带24 dB／oct的低通滤波器，对碰撞台产生的半正弦波的峰值、脉宽、速度改变量进行测量时，要求半正弦波处于仪器产生的公差带之内，半正弦波脉宽最小为3 ms。
2　系统总体
2.1　系统的外观和结构
　　由图1所示，系统由冲击测量仪及置于仪器外的绘图打印机,电荷放大器,传感器组成。该系统有16个按键，放大器有3个档位。系统的结构框图如图2所示.

图1　系统外观示意图
2.2　操作
　　开机上电，在汉字提示下输入参数，每输入一个参数按回车键。需输入预计峰值,预计脉宽,电荷放大器输出档位,传感器输出极性,放大倍数等5个参数。按“采样”键，即显示“采样”汉字，仪器开始采样，等待信号的到来。采样结束后，屏幕上显示出实测波形，并在右上角显示波形的峰值、脉宽、速度改变量。
　　随时可按“公差带”键,“打印”键,“实测波形”键,“置参数”键，“采样”键，仪器则进入相应的工作状态。
3　硬件实现方法
　　在IBMPC机主板插槽上,插有打印显示板、按键板、A／D转换板、BIOS扩展板，机箱内还装有电源板、模拟放大滤波器板。
1)打印显示板。
　　对仪器的屏幕显示、打印、绘图进行控制。
2)A／D板。
　　对模拟信号进行转换。其上有Z80CPU一片，4KROM、4KRAM，ADC674型A／D转换器一片。本板的数据总线与PC机主板的数据总线之间由74LS244分开／连通。ROM内存有约0.5 K程序，Z80CPU在A／D板上自成系统，由它控制A／D转换过程。当PC机主板CPU8088使Z80CPU进入总线请求状态，Z80CPU各脚输出都为高阻态时，主板CPU8088从A／D板的RAM取走A／D转换数据。
　　ADC674的A／D转换可在21 μs内完成，加采样／保持时间，一次A／D转换25 μs可完成，当需测的冲击波形最小为3 ms时，有120个采样点来描绘这个波形。
3)按键板。
　　用3个内存地址A1390H、A1392H、A1394H控制16个按键，3个档位，共19个键(档)。
　　采用非编码键可少用器件\,简化程序,提高运行速度\.
4)BIOS扩展板。
　　由DC000H开始，12 KROM，由74LS138、3片2732、3片74LS244组成，如图3所示。74LS244的作用在于增加地址线的驱动能力。\.
　　DC000H地址处在扩展BIOS的区域内，并且不与其它设备冲突。
5)模拟放大滤波板。
　　低通滤波器，按需滤波的不同频率，用琴键开关接通不同的电阻、电容，如图4所示。
6)电源板。
　　为DC―DC 5 V→±15 V电源模块。

图　2

图　3
4　软件实现方法
1)与ROM BIOS的接口。
　　按第0字节为55H，第一字节为AA，第二字节为长度说明的办法，ROM BIOS将控制交给扩展的BIOS后，就不再退出，而是在扩展的BIOS里循环运行。
2)汉字。
　　16点×16点字模，每个字占内存32个字节，集中存储。显示时每二字节为一行，放到对应的列上，组成汉字。
3)数据处理.
　　按采样最初的128个点求平均值，作为0点。按采样所得最大值与0点之差，算出峰值。0点起，峰值的8％处至30％处，求出一条最佳直线，与0点

图　4
线相交处为脉宽的起点，类似地求出脉宽终点，起点终点之间为脉宽值。用矩形积分法算出速度改变量。
4)显示。
　　没有采取中断方式，彩色／图形显示器占用I／O地址为3 DOH～3 DFH，按地址将显示控制器置成图形方式。
　　显示器的RAM占用8088地址为B8000 H～BBFFFH，按地址、按字节的位，送需要显示内容，某地址字节的某位为1，则显示一个点。屏幕显示每16 μs为一帧，一帧结束回扫需4 μs，送入显示器RAM的数据，每隔16 μs送4 μs，分批送完。
5　结论
　　冲击测量系统Ⅲ的研制达到了JJG498―87的要求，用通用板研制专用仪器，可达到快速、可靠、降低成本的目的。
作者单位：长城计量测试技术研究所，北京市，100095
参考文献
1.张载鸿.BM―PC／XT软硬件系统分析与应用
2.朱传乃,郑筑鸣,杨福平.微型计算机系统原理分析与维修
3.中华人民共和国国家计量检定规程JJG498―87凸轮式碰撞试验台
收稿日期：1998-05-26收稿
