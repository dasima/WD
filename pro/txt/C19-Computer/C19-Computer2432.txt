计算机研究与发展
JOURNAL OF COMPUTER RESEARCH
AND DEVELOPMENT
1999年 第36卷 第12期 Vol.36 No.12 1999



人脸的层次化描述模型及识别研究
章高清　　　王申康
摘　要　人脸自动识别是一个困难但有重要意义的工作.文中提出了一种基于人脸层次化描述的识别方法.该方法首先对人脸进行快速准确的特征定位及标准化，然后采用主元分析神经网络分别对定位的人脸及其特征区域进行最佳特征提取，从而得到人脸在低分辨率和较高分辨率上的两层特征描述用以识别，具有识别率高、特征数据量适中、可用于大量人像识别等特点.此方法在1300幅人像上进行了测试，结果表明其在人脸转动、表情变化或人脸未经训练等情况下仍可以很好地识别.
关键词　人脸标准化，主元分析，层次化描述，积分投影
中图法分类号　TP391.4
THE LAYERED FACE REPRESENTATION MODEL AND
FACE RECOGNITION
ZHANG Gao-Qing and WANG Shen-Kang
(Department of Computer Science, Zhejiang University, Hangzhou 310027)
Abstract　Automatic human face recognition is a difficult but significant problem. A novel method for face recognition based on layered face representation is put forward in this paper. The method first locates the face and key facial features including eyes, nose, and mouth in image quickly, and then normalizes that face depending on the center location of eyes. Then PCA neural network is used to extract characteristics of the located faces and facial features. This can be viewed as a layered representation of faces: where a coarse and low-resolution description of the whole head is augmented by additional high-resolution details in terms of salient facial features. This method has been tested on 1300 facial images and shows better performance than traditional PCA for face recognition, especially when head poses and expressions are changed.
Key words　face normalization, principal components analysis (PCA), layered representation, integral projection
1　引　　言
　　人脸是人类独一无二的特征，即使一对双胞胎其脸部也存在某方面的差异.虽然人类在表情、年龄或发型等发生巨大变化的情况下仍可毫无困难地检测和识别出人脸，但要建立一个能够完全自动完成识别任务的系统却是非常困难的，它涉及到以下几个问题：①把一种模式检测为人脸；②脸部表情分析；③基于特征的分类.由于能够实现上述功能的系统具有广泛应用前景，如嫌疑犯照片识别、丢失儿童信息检索、建立安全系统、信用卡确认等，在过去20年中，人脸自动识别领域吸引了众多的研究者，但目前能完全有效解决上述问题的系统尚未推出.
　　现有的人脸识别方法基本可分为两类［1，2］：一是分离的、基于局部特征的识别技术；二是整体的、基于全局特征的识别技术.前者分析人脸的各个组成部分，抽取离散的局部特征作为人脸的索引，然后用它们作为度量采用标准模式识别技术来识别.后者则从整体上捕捉和描绘人脸的特征，将整个人脸作为一个全局的描述.由于这些方法只注重局部特征或整体特征某一方面的描述，一般要求人脸变化不能太大，在人脸转动、表情变化时往往不能达到令人满意的效果.针对上述问题，本文在采用主元分析神经网络的基础上，将上述两类方法进行结合，构造出人脸的层次化描述模型用以识别，从而提高在人脸发生一定变化时系统识别的准确率.　　
　　在对人脸进行快速准确的特征定位和标准化之后，本文采用主元分析（PCA）神经网络对定位的人脸区域和特征区域分别进行特征抽取，得到相应的人脸全局特征描述层和局部特征描述层，这样，低分辨率上整个人脸的粗糙描述和较高分辨率上脸部突出特征的详细描述就构成了人脸的层次化描述模型.基于层次化描述模型的人脸识别方法克服了典型PCA算法［3，4］的一些缺点，如①会被人脸转动、表情变化等所欺骗；②对没有训练过的人脸的识别能力较差等.同时，由于PCA算法具有抽取特征数据量少的特点，所以用于表示人脸层次化模型的特征数据量适中，这样，更能适应大量人像的识别.本文假定：图像中只有一个人脸，且背景较为简单.
2　人脸标准化及特征定位
　　人脸标准化和人脸局部特征的定位是人脸识别任务的前提和基础，直接影响最后的识别效果.因此，快速准确的标准化和特征定位是十分必要的.
2.1　人脸标准化
　　本文在人脸标准化的同时也完成了人脸及眼睛的自动定位，其基本思想是基于一个简单的事实：对所有的人脸图像，头发和眼睛都很容易与脸颊明显分开，因此只要人脸图像能被很好地分割，就可将眼睛准确检测出来，并同时完成人脸的定位，这样，标准化问题便可得到容易解决.被标准化后的图像大小为128×192像素，人脸中两眼在同一水平位置.
2.1.1　域值分割
　　由上所述，首先需对人脸图像I(x,y)进行域值分割，使头发、眼睛与脸颊明显分开.由于假定图像中只存在一个人脸，分割问题变得相对简单.图1（b）是人脸图像的典型直方图，其中两个明显的峰值分别对应于人脸的暗部（头发、眼睛、眉毛、嘴等）和亮部（额头、脸颊等）.而且第一个峰值应对应人脸暗部，因为一般背景总比人脸的暗部亮，这样，我们只需找到前两个峰值，在其间取一个灰度值作为域值即可.由于存在多个可选域值，可通过自动域值调整使图像的二值化过程非常可靠.
　　直方图中常会因图像本身的灰度分布及噪声干扰等因素影响而出现一些类似峰点的随机干扰点，它们的存在会导致对峰点的误判，从而影响域值的选取.因此在自动检测峰点之前，需对直方图进行移动平均平滑预处理：

式中Gi表示灰度值为j点的移动平均值，gi表示直方图中灰度值为i的像素出现的频数，n为每次移动地求算术平均值采用的灰度级个数.移动平均其实质是对离散数列加以平滑处理来消除随机扰动点.若一次移动平均仍不能满足需要可对Gi（n取相同值）数列作二次或三次移动平均，方法类似.一般进行二次移动平均即可达到满意效果.图1（c）是对图1（b）作二次移动平均后的结果.可见其整体上与原直方图无明显改变，但许多干扰点被消除了.
　　所以，通过对原始图像直方图作二次移动平均，可准确检测出前两个峰值，得到可靠的域值进行分割，使头发、眼睛与脸颊明显分开.图1（d）是域值分割后的二值图像B(x,y).

图1　原始图像的域值分割
2.1.2　眼睛定位
　　一般眼睛定位采用模板匹配方法［1，2］.但单一模板匹配很难适应人脸大小不同的情况，而由Yille等人［5］提出、Xie等人［6］改进的基于弹性模板匹配的脸部特征抽取方法虽然稳定可靠，仍存在着计算量大、能量函数很难适应一般情况等缺点.本文则提出了一种称之为面积法的眼睛定位方法，此方法基于域值分割后的二值图像B(x,y)，利用人脸的一些简单先验知识，可以快速而准确地定位眼睛，而且，同时完成人脸定位（见图2）.下面是眼睛定位的主要步骤：
　　(1)通过第一次扫描二值图像B(x,y)定位头发
　　在扫描B(x,y)的过程中按照八连通原则，采用相邻点标记算法标记出各个1值块.一般来说，在背景较为简单的条件下，面积最大的一块即为头发块，这个假设通常是成立的，即使对光头或白发人来说，其头部灰度也是比较小的，因此用自动域值调整发法也能将头部找出来.
　　(2)通过对头发块的处理，定位头发内边界，生成人脸内轮廓图I′(x,y)
　　在定位头发块后，再作一次从上到下的局部扫描，可以得到头发块的下边界曲线，针对头发块中可能出现0值斑点，我们用平均值方法进行修正，观察这条曲线，我们发现在左右两边各有一个极小值（即在鬓角的部位人的头发延伸到下方）.找出这两个点，可再生成一个人脸内轮廓图I′(x,y)，该图顶端为头发下边界曲线的最高点，左右两端为找到的两个极小值点位置，底端为顶端加上左右端间距的1.5倍与整幅图像上分界的较小值.
　　(3)对人脸内轮廓图I′(x,y)应用拉普拉斯算子，做第二次扫描，定位双眼
　　使I′(x,y)中的每点灰度乘以以下矩阵：

-1-1-1
-18-1
-1-1-1

图2　变形的二阶微分模板

图3　眼睛定位示例
　　经过上述处理的图像是边界敏感的，同样对它做域值分割，然后进行全图扫描，方法与定位头发块相同，此次找出面积最大的10个块，做分对处理，标记出可能为双眼的成对块，经过下面规则判别出最有可能成为眼睛的一对，然后取出这一对块中最黑的点作为眼睛中心点.
　　判别眼睛对所用的主要规则：
　　(1)眼睛块宽度(width)、高度（height）及面积(area)应满足：
width > height and area > 0.5
　　(2)眼睛块I′(x,y)到上边界的距离d1与其到I′(x,y)下边界距离d2应满足：
d1<d2(眼睛应在人脸的上半部)
2.1.3　标准化
　　首先利用眼睛中心点对人脸姿态进行标准化：将图像I′(x,y)随着两眼中心点连线l旋转至l达到水平位置，生成图像I″(x,y)；然后对I″(x,y)进行缩放变换，使最后图像Inorm(x,y)尺寸为128×192像素，完成人脸大小的标准化.一般图像Inorm(x,y)的顶端在眉毛的上边界，底端在下唇至下颏间（因人而异），左右两端均在颧骨附近（见图4），这样使脸部关键区域凸现出来，图像识别的范围大大缩小了.

图4　人脸图像标准化示例
2.2　特征定位
　　眼睛定位后，鼻子、嘴等其它人脸局部特征可通过区域内积分投影［7］的方法方便定位.
　　由于已求得眼睛的具体位置，脸部中心线也随之确定，鼻子和嘴巴恰好在这条中心线上，并在眼睛下方（因为标准化时对头部倾斜的人像已经以双眼为标准作了旋转，所以无需考虑头部旋转情况），则根据人体测量标准，鼻子和嘴巴的垂直位置可初步确定.
　　鼻子的精确位置可以通过寻找垂直梯度图的水平投影的峰值确定，而嘴的位置由原图的水平投影的谷值确定（嘴唇之间的线是区域中最黑的部分）.峰值和谷值用它们的突出性来评价，具有最高评价值的即作为鼻子和嘴巴的垂直位置.获得精确的垂直位置后，搜索可进一步限制在更小的窗口内.
　　鼻子的水平定界在新的搜索窗内进行，在其水平梯度图的垂直积分投影上寻找高于搜索窗内平均值的峰值，最左和最右的峰值处分别为鼻子的左右边界.嘴的高度可由相同方法在垂直梯度图上得到，而嘴的水平位置则通过以平均值分割其水平梯度图的垂直投影，然后在上面寻找两个跳变点即可确定，特征定位结果如图5所示.得到人脸及其局部特征的位置后，就可进行识别了.

图5　特征定位示例
3　人脸识别
　　人脸识别基于主元分析法（PCA）进行.人脸图像可以看作一个矢量：如果图像的高度和宽度分别为h和w，则对应的矢量维数为w×h.人脸矢量属于一个空间，称为图像空间，由所有维数为w×h像素的图像组成.由于所有人脸极为相似，所有人脸矢量都聚集在图像空间的一个狭窄的区域内.所以，整个图像空间不是人脸描述的一个优化空间.主元分析法的任务就是构造一个能更好描述人脸的人脸空间，降低空间维数，使新的人脸空间的基向量（称为主元）能更好地描述典型的人脸模式.
3.1　主元分析神经网络
　　主元分析法虽然是在统计学领域发展起来的，但后来在人工神经网络中重新定义并得到广泛应用.基于Widrow-Hoff规则的线性自相关矩阵存储器（LAMM）［8］可看做一种主元分析神经网络，它的目的是产生一个最接近于输入键的已存储键的反应，在此键可认为是一张人脸.LAMM由一个神经网络层构成，每个神经元与人脸矢量中的一个元素相对应，每层包含w×h个神经元，且每个神经元与所有其它神经元相连，如图6所示.

图6　线性自相关记忆的结构
　　LAMM在训练过程中采用Widrow-Hoff规则不断改变权值使误差达到最小：
wij(t+1)=wt+η×(xj-oj)×xi
(1)
　　其中，xi为输入人脸矢量的第i个元素，oj为第j个输出神经元，wij为第i和j个神经元之间的权值，η为学习因子.对LAAM而言，期望的输出神经元oj就是它的输入xj，即如果权值产生的结果与预期不同，则需改变.
　　设I=w×h为人脸像素个数，亦为人脸矢量维数，K是训练集中人脸总数，X=［xij］是维数为I×K的训练集矩阵，其中第k列向量xk对应训练集中第k个人脸且被归一化，W=［wij］为维数I×I的权值矩阵.那么学习规则（1）又可写为
W(t+1)=W(t)+η×(X-W(t)×X)×XT
(2)
　　由式（2）则可说明此规则的收敛性.
　　矩阵X可写为X=P×Δ×QT.其中，P为矩阵X×XT的特征向量矩阵，Q为矩阵XT×X的特征向量矩阵，是包含矩阵X×XT特征值的对角矩阵.由定义，P×PT=I，Q×QT=I，I为单位矩阵，则根据式（2）可得：

　　所以，规则式（2）可写为
W(t)=P×(I-(I-(η×Λ)t))×PT
　　若取：为矩阵X×XT的最大特征值，则所以，当学习过程结束时，权值矩阵为，输出为
　　输出又可看成由y=PT×x和o=P×y两部分组成，其中x为一人脸矢量，o为输出人脸，y是中间形式，即矩阵P把人脸矢量x从图像空间转换到人脸空间中的矢量y，矩阵P的列矢量就是人脸空间的基，称作主元.表示中间形式的神经网络如图7所示，其中，rank(X×XT)=min(w×h,K)，通常K小于w×h，所以新构成的人脸空间维数较图像空间的维数减少了.
