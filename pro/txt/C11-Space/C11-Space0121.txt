航空计测技术
AVIATION METROLOGY & MEASUREMENT TECHNOLOGY
1999年 第1期 No.1 1999



刀形检测系统及空间测量坐标系的建立*
孙旭东　林玉池
　　摘　要　论述一种基于二维视觉测量的刀形检测及调位系统。给出了测量系统的机械结构以及刀具测量的原理，分析了系统测量坐标系建立的原理和方法，并给出了相关的实验数据。系统的研制实现了高效、精确、自动的刀形检测和刀具位置调整，为高精度数控加工提供了保障。
　　关键词　刀形检测系统　坐标测量　刀具预调
Setting-up of the Tool Form Measurement System and
Space Measuring Coordinate System
Sun Xudong,Lin Yuchi
　　Abstract　A kind of test and positioning system based on 2D vision measurement is described in this paper.The mechanical construction of the measurement system and the principle of the tool form measurement are proposed.The setting-up principle and method of the measuring coordinate system of the system are analyzed.The relative experiment data are given.The development of the system has realized high efficiency,accuracy,auto-test of tool form and positioning of the tool.Thereby the assurance for high accuracy digital control tooling has provided.
　　Key words　Tool form test system,Coordinate measurement,Tool presetting

　　引言
　　数控机床及加工中心的高精度、高效率，使它的应用越来越普及。由于在程控加工过程中机床要自动完成对切削刀具的控制，所以，在加工前必须形成刀具信息库，以便加工控制程序及时获取必要的刀具参数，实现在加工前和加工过程中刀具进给量的自动调整，达到高精度、自动加工的目的；因此，刀具检测系统便成为数控机床和加工中心必不可少的设备。它的作用就是迅速而准确地测量出每把刀具的几何参量并输入计算机，从而形成数控机床加工中心所需的各种刀具信息，为实现高精度的自动加工提供必要的前提和保证。
　　本文给出的二维视觉刀形检测系统，把CCD技术与计算机技术相结合，实现刀形和刀具位置的综合测量。与传统的光学投影式和线阵CCD瞄准发讯式刀具检测仪相比，它不但能进行刀具预调初始点的测量，还能够对刀形轮廓进行测量，便于在加工过程中对刀具上不同的切削接触点进行补偿，可用于包括复杂形面在内的各种加工；并且测量精度较光学投影测量大大提高。
　　对刀具轮廓特征点的的测量涉及到二维CCD确定的视觉坐标系(I，J)和机床导轨确定的机床坐标系(X，Y)。由于二维CCD的测量范围有限；因此，视觉坐标系下的测量结果需转化为机床坐标系下的测量值，同机床光栅尺的读数合成后才能形成最终所需的刀具参数；因此，这两个坐标系的确定以及它们之间的相互关系的建立，成为刀具检测的必要步骤；同时，在坐标系关系确定过程中的系统定标、定零、角度测量的精度将直接影响到刀具轮廓特征点坐标的测量精度。
1　刀具检测原理及空间测量坐标系的定义
　　当用具有一定曲率半径刀尖的刀具对工件进行切削时，不同的切削对象，刀具与工件间的接触点不同。常见的如圆柱面的切削和端面的切削，刀具上参与切削的点是固定的，即图1中所示的固定点A、B参与切削。在机床坐标系中，只要确定刀具预调点P(R，L)的坐标，并以该点作为切削起始点，就能实现对刀具的预调；但在锥面或球面加工中，刀具与工件的接触点由A到B点变化，这时AB段圆弧上每一点的半径值都影响被加工工件尺寸；因此，高精度加工中还有必要对AB段的刀形进行测量。

图1　刀尖局部放大
　　图2给出了基于二维视觉测量的具有刀形检测功能的刀具检测系统。刀具由定位系统固定在底座上，CCD摄像机和成像光路安装在支撑臂上，并由步进电机驱动沿机床的X、Y向导轨运动，Z轴方向的运动用于刀具在成像系统中的调焦，而在实际设计中，当确定刀具成像系统参数后，在测量过程中刀具没有Z方向的位移。测量时移动支撑臂，使刀具尖端轮廓像进入CCD视场，然后便可进行测量。二维CCD输出测量视频信号，在后续的处理电路中，采用硬件解调测量法完成边缘轮廓特征点的提取，由软件控制数据的读入和处理，并完成测量点空间坐标的转化，最后形成刀具参数。

图2　刀具检测系统
　　测量机床的X向和Y向导轨确定机床坐标系(X，Y)，坐标变动量由安装在导轨上的光栅尺的读数给出。由于X、Y向光栅尺可在任意位置置零，因此机床导轨只确定了机床坐标系X、Y轴的方向，而机床坐标系(X，Y)的原点位置并没有确定。
　　视觉坐标系(I，J)由二维CCD的横扫描方向和纵扫描方向分别确定，坐标变动量由视觉系统的定标值给出。视觉坐标系的原点位于每场首行扫描的起始点处，由边缘提取电路确定在场消隐信号过后第一个行消隐信号的后沿位置。
　　在测量前，必须确定视觉坐标系(I，J)和机床坐标系(X，Y)，并建立二者的相互转化关系，以实现视觉坐标系下的测量数据向机床坐标系的转化。
2　系统定零
　　系统定零确定出机床坐标系的原点位置，同时也建立了机床坐标系同视觉坐标系间的平移关系。
　　选择空间一定点，并将该点置为机床坐标系的原点。对这一定点的要求是：①空间位置唯一确定，不随机床导轨移动；②位于二维测量坐标系内，可以被视觉系统通过测量确定其在视觉坐标系中的坐标。由于这一定点对机床坐标系是坐标原点；对视觉坐标系是可测的视觉坐标已知点；对空间同一点在两共面坐标系下的坐标都已知，则机床坐标系同视觉坐标系间的关系便建立了。
　　空间定点是由零点棒上一标准圆球的球心给出的。零点棒是一具有标准位置尺寸的部件，定零时，安装在图2所示安装刀具的位置，定零完成后，再换上刀具进行测量。图3为系统定零的示意。

图3　系统定零原理示意
　　系统定零时，移动支撑臂沿机床X向和Y向导轨移动，使零点棒上的标准圆球进入CCD视场中的任意位置，锁定机床导轨，并将机床导轨上的光栅尺置零。此时圆球球心在视觉坐标系中的坐标(i，j)由视觉系统测得，该坐标值对应在机床坐标系中为(0，0)。则(i，j)便作为定零参数用以建立视觉坐标系同机床坐标系的平移关系。
　　实际测量时，为避免不同的定零操作产生不同的定零参数，便于测量数据的比对，圆球并不锁定在CCD视场中的任意位置，而是选取视觉坐标系中CCD感光面中心作为测量参考点，在视觉系统横向扫描定标值为0.214 μm脉冲，纵向扫描定标值为2.648 μm／行时，该点在视觉坐标系中的坐标值为(1059.0，827.5)μm。定零时，移动支撑臂使圆球球心同该点重合，在此位置将光栅尺置零。在这种方法下，影响定零精度的因素主要是CCD安装的稳定性和圆弧拟合的精度。多组定零实验表明：X向的重复性精度优于0.5 μm；Y向的重复性精度优于0.3 μm，可满足定零要求。
3　坐标系夹角测量
　　坐标系间的夹角指的是视觉坐标系同机床坐标系间的夹角。
　　视觉坐标系同机床坐标系间的夹角是必然存在的。首先，边缘提取采用的解调测量法要求将CCD旋转一定的角度安装，这是由于当CCD扫瞄线同刀具边缘轮廓相切时，解调测量法不能获得相切处的轮廓点坐标；因此，CCD的扫瞄线应避免同刀尖处的轮廓相切。其次，由于在CCD安装时，很难做到将CCD精确地旋转一角度值；因此，有必要对这一未知角度进行测量。
　　坐标系夹角测量采用移动法，示意如图4所示。

图4　坐标系间夹角测量
　　图4中的AB为沿机床导轨X向的标准位移，由机床光栅尺读数给出。CCD摄像机沿机床X向导轨由A点移动到B点，而锁住沿Y向导轨的运动，由CCD分别测得A点和B点在视觉坐标系下的坐标值。当视觉坐标系的I轴同机床坐标系的X轴平行时，CCD测得的A、B两点的J向坐标值应相同；但当两坐标轴存在一夹角时，A、B两点的J轴坐标会相差一距离，即图4所示的BC，由此可以得到两坐标轴的夹角为
sinφ＝BC／AB(1)

　　对于A点和B点在视觉坐标系下的坐标值的测量，采用两标准钢球的拟合圆心。同样方法，可以测得机床的Y向导轨同J轴的夹角，在不考虑导轨误差时，两次测得的夹角应相同。
　　增大移动距离AB可以提高角度测量的精度；但会增加机床导轨误差的影响。图5给出了在CCD视场范围内移动测角的三组测量结果，测得X轴同I轴的夹角为1°33′。在CCD视场内当仅移动Y向导轨，有最大移动量1655 μm和最小X向变化量0.214 μm，系统可测得最小角度为26.67″。

图5　夹角测量实验
4　坐标系的统一
　　采用二维CCD作为视觉传感器的刀具检测系统，当CCD稳定安装后，并在空间确定一位置固定的系统定零点，测量坐标系及其关系也就唯一确定了。
　　对于视觉系统测量范围内的坐标变换公式如下：
(2)

式中，φ为机床坐标系同视觉坐标系间的夹角；(i，j)为视觉坐标系下的坐标；(i0，j0)为坐标平移量。
　　若选定点为视觉坐标系中点(i，j)＝(1059.0，827.5)，定零后该点成为机床坐标系的零点，则有(x，y)＝(0，0)，代入(2)式，在坐标系夹角φ已知的条件下，即可求得坐标平移量(xd，yd)
(3)

　　CCD视场测量范围之外的坐标平移量，由机床导轨上的光栅尺给出，总的坐标变换式为
(4)

　　式(4)中的(X0，Y0)为机床导轨光栅尺的读数。
　　测量时，只要刀具尖端轮廓像进入CCD的视场范围，测出此时刀尖轮廓点在视觉坐标系下的坐标值，并由微机接口读入此时机床X、Y光栅尺的读数，即可由软件依据(3)式、(4)式完成测量数据坐标值的转化。
5　结论
　　系统测量坐标系的建立，形成了CCD视场中每一刀具轮廓特征点的机床坐标值，使二维刀具检测仪实现了刀形检测功能， 从而克服了光学十字叉丝瞄准和两垂直线阵CCD发讯瞄准，只能进行刀具预调点P测量的限制，提高了测量精度和自动化程度，拓宽了数控机床及加工中心的性能。
*天津市自然科学基金项目.NO.953601111

24岁　男　博士研究生　读者服务卡索引号： 110
作者单位：天津大学精密仪器与光电子工程学院，天津市，300072
参考文献
　[1]　Doiron T D.Computer Vision Based Station for Tool Setting and Tool Form Measurement.Presion Engineering,1989,1,11(4):231～238
　[2]　Murn R and Pecek D.Comouter Vision Measurement System.Institute Jozef Stefan,Ljubljana,Jugoslavila,Measurement,1990,8(4)
　[3]　Lin Psang Dain.Machine tool settings for manufacture of cams with flat-face followers.International Joural of Machine Tools & Manufacture,1994 34(8),1119～1131
　[4]　邹仲力.提高CCD尺寸分辨力的解调测法.仪器仪表学报,1986,7(1):3845
1997-11-03收稿
