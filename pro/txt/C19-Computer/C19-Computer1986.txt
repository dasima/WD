微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
1999年 第18卷 第2期 Vol.18 No.2 1999



8098单片机在埋地管线防腐层检漏仪中的应用
陈祥光　薛锦诚　张自立
　　摘　要：基于智能仪器设计的基本原理，以MCS-8098系列单片机为核心芯片，实现管线防腐层检漏的方法。
　　关键词：智能仪器　单片机系统　数据采集　数据通信　检测技术
　　利用电磁原理进行防腐层状况检测的方法适用于石油工业或其它工业的地下金属管线的防腐层质量检查。近十几年来发展了地面检测技术，在不开挖土方的情况下就能在地面上方便而可靠地查出管线的漏铁点(或漏点)的位置。本文介绍的以8098单片机为核心研制的智能检测仪的主要特点是：基于现场的检测数据及专家的知识，可对管线防腐层的破损处或管线的漏点进行检测、判断及报警，借助于有关附件，可实现检测距离的计量和管线深度的判断。
1　防腐层检测技术的基本原理
　　本文运用电磁原理进行防腐层的探伤检测。如图1所示，与带电流I的长直导线的轴线相距d处的磁场强度B可表示为。若感应磁场通过产生电压的传感器的轴截面，则感应电压，K表示感应系数。当磁场平行于传感器轴线方向时，K为最大。若加在管线的电流为交流电，则很容易产生感应磁场，因为交流电的频率可被选择，通过迭频可滤去其它频率的信号或噪音。


图1　电磁原理示意图
　　当沿管线增大发射信号的频率时，对地电流相应增大，使管线破损点更易于被发现，但是继续增大频率会产生重叠干扰，影响管线防腐层破损处的定位。因此，检测管线防腐层通常使用的频率为1?000Hz左右。电流损失与防腐层状况有关，通过破损点前后电流比值可定量得到损失电流值。随着检测距离的增长，管线信号将逐渐衰减，当遇到破损点时，管线信号将有一个衰减尖峰，地表的磁通强度将突然增加，如图2所示。由图2可以看到，在遇到防腐层破损点时，管线电流有一个异常高的衰减，这样就导致地表磁场强度的突然增加，由此便可检测出管道防腐层的破损情况。


图2　防腐层破损处磁场强度分布图
2　智能检漏仪硬件电路设计及软件编程
2.1　整机硬件系统组成及其工作原理
　　1.整机硬件组成
　　整机硬件组成如图3所示。该检测系统由发射机、探管机、接收机、单片机系统4部分组成，单片机系统由8098单片机、键盘、显示器等外围器件组成，上位机为PC机(或其兼容机)。其工作原理为：发射机在管道上加一正弦信号，沿着管线形成电磁场，由接收机和探管机在电磁场中的电位差产生模拟信号，经8098单片机内的A/D转换后，进行数据存储、分析及报警，然后通过串口通信将检测数据送至上位机。

图3  智能捡漏仪系统组成图
　　2.单片机系统硬件组成
　　单片机系统的组成如图4所示。本系统采用的主要芯片有8098芯片、2764芯片(EPROM)、2864芯片(E2PROM)、8255接口芯片、ICL232芯片、DALLAS12887芯片(时钟)以及74LS373、74LS138、74LS00等。显示器采用16×2字符型LCD，键盘采用4×4触摸键盘。

图4  单片机系统的硬件组成
　　3.主程序框图
　　单片机系统软件主要实现系统参数设置、数据采集、数据分析、数据存储、漏点智能报警及上下微机通信等功能。主程序框图如图5所示。

图5  主程序框图
2.2　数据采集显示程序设计
　　由接收机发送来的数据经由8098单片机处理后，送到E2PROM进行保存，同时将检测信息送到LCD液晶显示屏显示，也可通过上位机对检测数据进行处理和显示。在这部分软件设计中，运用了MCS-8098单片机内A/D转换功能和EXTINT外部中断功能。A/D转换将信号接收机送来的模拟信号转换为数字信号，然后加以处理；用测步机的脉冲信号触发EXTINT外部中断功能，为系统提供测定距离的脉冲信号，以确定管线的长度。
2.3　数据存储技术及上下位微机通信程序设计
　　系统在对数据进行处理后，送入E2PROM中保存。同时还可将E2PROM中的数据发送给上位机，由上位机对数据进行二次分析和整理保存，在PC机中建立检测数据库。通过ICL23将8098的TXD和RXD与PC机的COM2口相连，实现了数据与指令的相互传输。

图6  上位机程序设计原理
　　上位机程序设计采用Borland C++4.5语言编程，操作环境是Win31。其主要功能是分析处理由单片机系统发送来的检测数据，可将分析结果以图形方式直观地显示于计算机屏幕上，同时程序还具有保存数据文件、打印实验报告等功能。程序菜单共有4项：文件(File)、数据接收与处理(Test)、显示数值(View)、帮助(Help)。其工作原理如图6所示。
3　智能检漏系统操作原理
　　如图7所示，一般输油管线每隔1km就有1个检测井，发射机便可通过井内阀门向管线施加发射信号，从而可以对管线进行分段检测。检漏工作一般由2名检测员(甲、乙)沿管线进行。接收机由走在后面的甲检测员背带操作。2名检测员均配带手表电极，2个电极间连有1段接收线。当2人站在不同电位处，经由人体电阻和电容将地面电场信号耦合到接收机内，进行放大后送至8098单片机。根据接收信号的强弱，确定漏铁点位置。探管机由走在前面的检测员乙背带，沿管线上方行进，用于检测管线的走向。


图7　埋地管线检测示意图
　　当2名检测员甲、乙先后走过漏铁点时，可以听到信号声有如下变化：渐强―强―最弱―强―渐弱。这种变化是由于2名检测员所处位置的电位变化而引起的。当甲乙2人逐渐走进漏铁点时，信号声逐渐增大。当乙达到破损点正上方时，信号达到最大；乙走过漏铁点后，信号又开始减弱，当甲乙2人离漏铁点等距离，即漏铁点处于2人中点时，信号最弱；当甲到达漏铁点正上方时，信号又增大到最大值；再继续前进，甲乙均逐渐远离漏铁点时，信号逐渐减弱。
4　结束语
　　本文采用的电磁波法是一种间接检漏法，它不是直接用于管线的泄漏检测，而是通过检测管线表面防腐涂层的损坏情况来了解管线的目前状况。一旦发现防腐涂层脱落、损坏，就进行维修，防止钢管与土壤接触，对减缓管的腐蚀速度，延长管线的使用寿命具有很重要的意义。同时，电磁方法检测效率高、检测结果较准确，适合于野外作业，因此，具有推广应用价值。由于采用8098单片机使检测系统的功能明显增加，如实时数据采集和显示、数据断电保存、长期运行的系统时钟、以及上、下位微机数据通信等。根据现场检测数据并基于专家知识可对漏点进行智能判断。
作者单位：北京理工大学化工与材料学院68教研室(100081)
参考文献
1　刘玉平，司光宇.油田管道防腐层的微机在线监控系统.大庆石油学院学报，1995；20(1)：104
2　刘伟，高廷禹.秦京输油管道防腐层劣化原因分析.油气储运，1996；15(6)：25
3　汤星朝.1993年世界各类管道防腐层使用情况及分析.油气储运，1995；14(1)：1
4　彭玉环.关于地下输油管线检漏方法的介绍.油气储运，1994；3(4)：35
5　方建淳.8098单片机原理及系统设计与实践.天津：天津大学出版社，1990
6　Sturgess R W.C-Scan System Can Evaluate Integrity of Buried Pipelines-Trouble-Shooting Tool.PIPELINE GAS JOURNAL,1988；(2)
(收稿日期：1998-09-10)
