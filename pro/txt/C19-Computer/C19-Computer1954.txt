微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
1999年 第18卷 第1期 Vol.18 No.1 1999



无线接入Internet的研究与实现
郭茂文　王永山
　　摘　要：介绍了利用一种智能化的无线Modem实现无线结点接入Internet的方法，并进行了无线电子邮件服务的软件实现。
　　关键词：无线Modem　无线接入　无线的电子邮件服务
　　随着以Internet为基础的数据通信业务迅速发展，如何接入Internet进行数据通信成为人们所关注的技术问题。本文采用一种自行设计的智能化的无线Modem将数字信号调制成语音信号，然后利用无线通信机进行传输，实现无线结点接入Internet。
1　无线接入设备原理
　　无线结点要接入Internet，必须在无线结点和Internet接入点之间增加1个设备，用来连接无线结点与Internet之间的通信，共享Internet资源并获取Internet提供的信息服务。这种设备通常称为无线接入设备。经过分析和研究，无线接入设备需满足以下的功能要求：
　　(1)无线接入设备既能接收和发送Internet信息，也能接收和发送无线结点信息。
　　(2)无线接入设备能自动进行无线结点与Internet之间的数据格式转换。
　　(3)接口方式简单。
　　根据以上的功能要求，在自行设计的智能化的无线Modem的基础上，我们开发出了一种无线接入设备，其硬件组成如图1。

图1　无线接入设备的硬件组成
　　(1)网络适配器：接收和发送Internet信息。
　　(2)智能化的无线Modem：该部件是无线接入设备的核心，由8031CPU、无线Modem芯片、数据存储器、程序存储器及其它辅助电路组成。它必须完成的功能是：把发向无线信道的信息调制成模拟信号传送给通信机；对从无线信道接收到的模拟信号解调为数字信号，必要时传送给计算机处理，实现差错控制和流量控制等。
　　(3)通信机：与Modem独立，用于接收和发送无线信息。我们实验时采用一般的UHF、VHF通信机。
　　(4)计算机：处理Internet信息和无线信息，必要时进行数据格式转换，并完成其它的管理功能。
　　网络适配器和智能化的无线Modem都置于计算机的总线扩展槽，其中，智能化的无线Modem与计算机之间的信息传输以RS232串行接口方式，与通信机通过4根信号线(收、发信号线，收发转换信号线，地线)相连。
2　数据格式转换机制
　　由于无线信息和Internet信息在传输中分别采用不同的数据格式，当它们的数据信息传送到对方时，必须进行不同的数据格式之间的相互转换，这一功能由无线接入设备实现。一般有2种常用的数据格式转换方式：(1)封装方式。即将1种完整的数据格式作为另1种数据格式中的数据域内容，也就是包含的意思。这种方式简单、易行。中间的无线接入设备不需解释数据格式的各类信息，只是简单的转发信息。(2)有效数据装配方式。即无论何种数据格式均针对其数据域进行处理。这种方式只传送有效数据，无线接入设备需要进行有效数据的提取，而且必须对数据结构进行识别。
　　由于所选的无线Modem芯片支持高级数据链路控制(HDLC)协议，无线结点与无线接入设备之间通信所采用的数据格式为HDLC帧格式。无线接入设备与Internet的通信遵循TCP/IP协议，通过对TCP/IP协议的应用层接口编程，就可以获得Internet数据格式中的数据域内容。因此，本文采用的数据格式转换机制是有效数据装配方式。
3　无线结点接入Internet的基本工作过程
　　图2是无线结点接入Internet的系统模型。在这个模型中，无线结点由计算机、智能化的无线Modem和通信机组成。无线结点和无线接入设备中的通信机采用同一频率。

图2　无线结点接入Internet的系统模玩型
　　无线结点和Internet服务器交换信息，必须通过以下过程：
　　(1)计算机与智能化的无线Modem之间的信息传送，通过RS232串行接口完成：智能化的无线Modem以串行口中断方式接收计算机发来的信息；计算机通过Windows消息机制接收智能化的无线Modem发来的信息。
　　(2)智能化的无线Modem之间经过通信机的信息传递：智能化的无线Modem经过通信机以HDLC帧格式传递信息。平时通信机处于接收状态，若无线信道中有信号，通信机可接收进来，以语音信号的形式传给智能化的无线Modem。为了保证接收数据的可靠性和准确性，智能化的无线Modem以可编程中断和非可编程中断交替使用的方式进行接收，然后，根据不同帧的内容进行处理。当智能化的无线Modem发送信息时，通过收发转换信号线使通信机处于发送状态，然后，智能化的无线Modem将信息调制成语音信号传给通信机向无线信道发送。发送完毕，再通过收发转换信号线使通信机处于接收状态。
　　(3)无线接入设备中的计算机与Internet服务器之间的信息传递：根据不同的网络事件，产生不同的Windows消息来接收各自的网络信息。
4　无线的电子邮件服务的实现
　　对图2中的模型进行相应的软件实现，就可以获得多种无线的Internet信息服务，如无线的电子邮件、文件传输等。由于电子邮件是Internet中最广泛使用的应用程序，因此，我们在Visual C++ for Windows3.2和8031单片机汇编语言环境下，利用Windows socket套接字应用程序接口，进行了相应的无线的电子邮件服务实现。这里限于篇幅，仅讲述其实现方法。
　　发送电子邮件时，遵循TCP/IP协议应用层的简单邮件传输协议(SMTP)；接收电子邮件时，遵循TCP/IP协议应用层的邮局协议(POP3)。这2种协议均由一系列命令组成，而且都有严格的先后顺序。它们在客户机和服务器之间提供半双工通信，客户机把命令发送到服务器上，接着服务器把应答发送回客户机。下面是在发送电子邮件时，客户机与服务器之间的SMTP命令传输过程的一个简单实例。
　　　Client;　　　　　　　　　　　　　Server:
HELO jnu.edu.cn　　　　　　　　　　250　guo.jnu.edu.cn
MAIL FROM:tyswang@jnu.edu.cn　　　 250 OK
RCPT TO:<yinfeng@public.xa.sn.cn>　250 OK
DATA　　　　　　　　　　　　　　　 354 start mail input
"My dear friend,…"　　　　　　　　250 OK
QUIT　　　　　　　　　　　　　　　 221 guo.jnu.edu.cn
　　通过对实例的分析，可以看出：SMTP和POP是建立在TCP/IP协议基础上的应用层协议，它们是通过执行具有先后顺序的命令来实现的，大部分命令都带有参数。而命令又是按照请求/应答模式来执行的，客户机每发送1条命令之后，处于等待状态，直到收到服务器的应答信息，服务器在接收到客户机的每1条命令后，都要返回应答码，应答码以3位数字字符来表示，每1位都表示不同的含义。客户机收到应答码之后，对应答码进行分析，以决定下一步的动作。
　　对于无线电子邮件服务，可以按照以下步骤来实现：
　　(1)用户在无线结点的界面上输入有关电子邮件服务的参数(如电子邮件服务器名、发送者的电子邮件地址、接收者的电子邮件地址等)，并按无线数据格式传输给无线接入设备。
　　(2)无线结点按照无线数据格式传送命令的自定义代码(如HELO命令用字符“1”表示，MAIL FROM命令用字符“2”表示等)给无线接入设备。
　　(3)无线接入设备接收到第1个命令自定义代码时，与邮件服务器建立Socket套接字连接。无线接入设备与邮件服务器建立好连接后，每次，根据接收到的命令自定义代码发送相应的命令给邮件服务器并等待邮件服务器的应答。
　　(4)无线接入设备接收到邮件服务器的命令应答码后，将应答码按无线数据格式传输给无线结点。
　　(5)无线结点接收到应答码后，通过对应答码的分析决定下一步动作。
　　实际上，电子邮件协议的实现是在无线接入设备和电子邮件服务器之间完成的，无线结点与无线接入设备之间仅传输协议的有关参数及执行结果。
　　这种实现无线的电子邮件服务的方法易于理解，普遍适用于无线实现以命令方式为应用层协议的Internet信息服务。
　　本文仅实现了单个无线结点与Internet的通信。若有多个无线结点，可组成无线局域网，并采用多址技术，改进无线通信机部分，实现无线局域网与Internet的互联。
作者单位：广州暨南大学物理系(510632)
参考文献
　1　罗惠琼，杨国渝.无线互联系统技术研究.电子科技导报，1996；(12)
　2　Advanced Electronic Applications,Inc.PK-80 Packet Controller Operating Manual.1985
　3　何立民.单片机应用系统设计.北京：北京航空航天大学出版社，1993
　4　斐纯礼.Windows环境中的Socket开发与应用.微电脑世界，1997；(7)
　5　王齐.Windows环境下的串行通信.微电脑世界，1997；(3)
(收稿日期：1998-07-25)
