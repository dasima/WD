微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
1999年 第18卷 第1期 Vol.18 No.1 1999



PLC在电力监控系统中的应用
黄俊辉　叶念渝
　　摘　要：介绍PLC在化工厂电力监控系统中用于数据监测和输出控制的程序设计及应用。
　　关键词：可编程逻辑控制器PLC　电力监控系统　同期检查　并列操作　工业控制微机
　　PLC作为监控系统的一种现场设备，因其出色的数据采集和可编程控制能力而受到众多用户的青睐。在笔者参与开发的一化工厂电力监控系统中，系统要求能完成35kV进线、各馈线和母联的交流电气参数如三相电压、电流、功率因数、有功功率，整流输出电流、水温、晶闸管控制角及主断路器状态、重瓦斯、开关柜气等近400多个量进行监测，并能实现高压总变电所及低压所的逻辑控制功能。我们选择智能仪表和PLC共同组成现场设备，实现系统监测和控制功能。PLC选用德国Siemens公司最近推出的S7200 PLC系列。其主要模块性能为2048程序存储器，2048数据存储器；14点输入、10点输出、可扩展7个模块；内带128个定时器，128个计数器，快速逻辑处理器等；用户可自定义协议通信中断；数据存储时采用超大容量190小时不加电池；3级密码保护；实时时钟。模拟量输入输出模块A/D、D/A，精度为12位。本文将主要介绍PLC在高压总变电所的控制应用。
1　控制要求
　　高压总变电所系统简图如图1。

图1　高压开关所系统简图
　　该化工厂由2路35kV进线即一段进线和二段进线供电。2路进线分别来自不同变电站，2段母排间有一母联断路器(350柜中)，通过闭合母联断路器，任一段进线可供厂内2段用电，使得由故障引起的停电时间尽可能短，停电面积尽可能小。高压开关所需检测量达20多个(都为开关量)，控制量为7个。为完成这些量的监控，需选用1个PLC主模块(214模块)和3个扩展模块(221模块)。状态量经通信送到工业控制微机显示。系统要求PLC能实现某些情况下对二进线主断路器及母联断路器的控制操作。为确保化工厂在某段进线停电时厂内该段不停车，于二段进线间装有一同期装置(PT位于进线断路器之前)，用于检查2路进线供电是否同期，同期信号送到PLC，用于并列操作的逻辑判断。例如供电局通知将停某一路进线，在停电之前，由中心控制室的上级工控机发出并列操作指令，再去现场手动执行同期检查，如信号同期，则PLC先合母联断路器，再分相应进线断路器。这样就确保了某段进线停电之前完成由另一路进线供厂内2段用电的操作。来电后，再执行相应的并列操作恢复正常供电。系统的具体控制要求如下：
　　(1)351合，352合，则350分(正常情况下)。
　　(2)一段进线失压，仪表保护分闸(351分)后，母联自投(350合)；一段进线来电后，执行并列操作3恢复正常供电。
　　(3)二段进线失压，仪表保护分闸(352分)后，母联自投(350合)；一段进线来电后，执行并列操作4恢复正常供电。
　　(4)在任何情况下，如某段(厂内)发生过流、速断等高压回路故障时，仪表保护分相应进线断路器，母联断路器也必须分。
　　(5)在供电局通知停一段进线后，执行并列操作1；恢复供电后，执行并列操作3。在供电局通知停二段进线后，执行并列操作2；恢复供电后，执行并列操作4。
　　(6)并列操作过程如下：
　　①并列操作1：发并列操作1指令，再到总变电所手动同期检查开关，如信号同期，则先合350，再分351；如不同期，则不进行任何操作。
　　②并列操作2：发并列操作2指令，再到总变电所手动同期检查开关，如信号同期，则先合350，再分352；如不同期，则不进行任何操作。
　　③并列操作3：发并列操作3指令，再到总变电所手动同期检查开关，如信号同期，则先合351，再分350；如不同期，则不进行任何操作。
　　④并列操作4：发并列操作4指令，再到总变电所手
　　动同期检查开关，如信号同期，则先合352，再分350；如不同期，则不进行任何操作。
　　(7)通过硬件互锁，确保350、351、352的断路器在任2个为合时，不能手动合另一个。
2　程序设计
　　为满足控制要求的实现，设计程序流程如图2所示。各模块的主要功能如下：


图2　主程序控制模块流程图
　　模块1：在智能仪表(失压进线上)保护分闸后，PLC控制母联合闸(自投)，然后判断哪段进线失压且置相应的标志位，以便PLC下次扫描时，进入模块3或模块4。　　
　　模块2：在各进线故障分闸后，PLC控制分母联350。
　　模块3：完成并列操作1。即在信号同期时，先合母联350，再分进线351。信号不同期则不发任何控制信号且退出；此后，如另一路进线出现故障，PLC要控制分母联350且清标志位，退出该模块。
　　模块4：完成并列操作2。即在信号同期时，先合母联350，再分进线352。信号不同期则不发任何控制信号且退出；此后，如另一路进线出现故障，PLC要控制分母联350且清标志位，退出该模块。
　　模块5：完成并列操作3。即在信号同期时，先合进线351，再分母联350。信号不同期则不发任何控制信号且退出。
　　模块6：完成并列操作4。即在信号同期时，先合进线352，再分母联350。信号不同期则不发任何控制信号且退出。
　　在该控制系统中，并列操作1和操作3、并列操作2和操作4各组成1套完整的并列操作动作(即在停电后执行并操1或2，来电后执行并操3或4)。在执行了并操1(2)后，若还没有执行相应的并操3(4)，PLC程序每次扫描时都会进入模块3(4)，直到并操3(4)执行完成才清掉所有进入模块3(4)的标志位。在程序的设计中，最有特点的是标志位的使用。通过置不同的标志位表示不同的现场状况及程序状态。如M20.1表示并操1指令，M30.1表示并操1维持指令等。通过这些标志位与现场状态位(如I4.7表示执行同期检查)的组合形成进入各模块的条件，这些条件充分考虑了现场可能发生的情况。该程序的设计不仅能完成既定的控制要求，还具有很强的稳健性，即能在一定程度上防止操作人员的误操作。如在工业控制微机没有发并列操作指令时，操作人员即使执行了同期检查且信号同期，PLC也不能动作。这些都可通过条件组合来实现。以下即为进入模块3和模块5的条件组合，如图3。

图3　部分PLC程序图
　　(1)执行并列操作1后未执行并列操作3前；(2)发并列操作3指令但未同期检查；(3)发并列操作1指令且同期检查；(4)一段进线失压，母联自投后。上述情况下，进入模块3，在并列操作1完成状态下，发并列操作3指令且同期检查，进入模块5。
　　上级工业控制微机怎样发并列操作信号给PLC?编程中利用了工业控制微机对PLC的单点遥控功能，在通信模块中将单点遥控输出(当然这些输出在该系统中空闲)改为置相应并列操作的标志位，从而得到通知PLC执行某并列操作的目的。
　　在PLC与工业控制微机的通信规约问题上，采用了与其它智能仪表(加拿大PML3000系列)相一致的规约，仅扩展其帧格式定义，具体协议如图4。

同步字设备
类型命令
字节信息
长度PLC地址扩展帧格
式定义FCS校验

图4　具体协议
　　扩展帧格式具体定义如图5。

标识起始地址数据长度数据

图5　扩展帧格式具体定义
　　FCS检验码值为从设备类型到数据的数值的异或结果。
　　购买PLC时可得到由供应商提供的PLC通信规约及相应的MODBUS通信模块，在此基础上用户可根据需要进行一定的编程。目前PLC的通信规约正向着标准、统一的方向发展，且直接固化在通信卡上，这样极大地提高了系统的兼容性和可靠性。
3　结论
　　本电力监控系统中，PLC作为1种现场设备，通过编制控制及通信模块程序，完成了高压开关所需的参数监测和输出控制功能。通过上电投产后的运行表明，该系统能准确地完成数据采集和控制操作，系统响应时间和数据传输正确率等技术指标都达到了预定要求。通过对PLC的离线或在线编程，可满足系统变化的控制要求；通过扩展I/O模块，实现对采集点数和输出量的扩充。PLC与其它智能仪表作为现场设备，通过现场总线与工业控制微机通信，共同构成分布式监控系统，也是目前世界上较先进、流行的监控方案。
作者单位：武汉华中理工大学自动控制工程系(430074)
参考文献
　1　陈春雨，李景学.可编程序控制器应用软件设计方法与技巧.北京：电子工业出版社，1993
　2　田瑞庭.可编程序控制器应用技术.北京：机械工业出版社，1994
　3　西门子公司.S7-200可编程序控制器操作手册.1997
　4　西门子公司.S7200-DOS编程操作手册.1997
(收稿日期：1998-06-22)
