微型电脑应用
MICROCOMPUTER APPLICATIONS
2000　Vol.16　No.1　P.36-37



兖州矿业(集团)公司局矿两极机电管理
信息系统的设计与实现
唐枚　口金海　张跃进　晏斐　魏明军
摘　要：文章介绍了兖州矿业(集团)公司局矿两级机电管理信息系统(YKJDMIS)的总体设计思想，以及基于C/S和B/S交叉并用的模式，利用大型关系数据库Oracle7.3和前端开发工具Visual Foxpro5.0开发的具体实现方法。其中，阐述了交叉并用C/S和B/S模式的优点，介绍了分布式数据库数据信息共享问题的解决办法，以及相关的计算机辅助决策功能的实现，文中还涉及到动态算法和动态报表的生成方法。
关键词：C/S　B/S　面向对象　分布式数据库MIS　计算机辅助决策
Abstract：This paper introduces the overall design of YanZ hou Mining (Group) Corporation’s Management Information System (MIS) of Mechani cal & Electrical Equipment on the Two Levels of Bureau and Mine. It also describ es the concrete implementation method of using large RDB Oracle 7.3 and the fron t end developing tool of Visual FoxPro 5.0 to develop such a system based on Cli ent/Server (C/S)and Browser/Server (B/S). It particularly explains the advantage s of cross usage of C/S and B/S and the solution to the problem of sharing infor mation in the distributed database, and the implementation of related Computer A ided Decision Support functions. The method of dynamic creation of arithmetic an d dynamic reports is also given in it.
Keywords：Client/Server　Browser/Server　object oriented　 Distributed Database Management Information System　CAD▲
一、系统概述
　　兖州矿业(集团)公司是我国煤矿行业的龙头，兖州矿业(集团)公司局矿两级机电管理信息系统(YKJDMIS)是兖州矿业(集团)公司管理信息系统的主要的子系统。兖州矿业(集团)公司下属二十多个厂矿企业，拥有机电设备二万多台。机电设备由集团公司机电处统一管理，厂矿设有机电科，专门管理机电设备。集团公司的机电设备分散在各厂、矿、设备租赁站等企业。这些企业在地域分布上比较分散，对管理部门及时掌握设备信息带来困难。开发机电设备管理信息系统的基本目标就是为管理部门提供及时，准确、完整的设备信息，减轻管理人员的工作负担，以便管理部门进行科学有效管理，为管理者进行科学决策提供依据。
二、集团公司行政组织机构及各部门职能
　　1.行政组织机构
　　集团公司行政组织机构如图1。

图1 集团公司行政组织机构图
　　2.局各业务管理部门职能
机电处：
　　(1)办公室
　　文档管理，包括收文、发文、归档、通知。
　　(2)设备科
　　机电设备宏观管理、设备固本、大修、安技措计划审批，设备事故，故障管理。各部门工作协调、编制年报表，收集机电设备信息，转发文件。设备台帐，设备调剂，电梯、起重机械、机动车辆的月检，年检管理。
　　(3)运转科
　　四大运转设备(水泵、空压机、通风机、提升绞车)动态管理，设备技术档案管理，矿井停产检修管理，纲丝绳、皮带动态状态跟踪，设备润滑管理，设备技术改造管理。
　　(4)电力科
　　用电管理。
　　(5)综合科
　　特种设备安全管理，包括锅炉、压力容器、厂内车辆。
　　(6)施工设备租赁站
　　设备租赁管理，设备购置，设备造型、租赁合同管理，设备大修管理，设备库存管理，租赁设备状态跟踪，租赁费管理。
　　(7)设备检测中心
　　设备性能、技术指标、运转状态检测管理。
　　3.厂矿企业
机电科：
　　设备基本信息管理。设备卡片、台帐管理，设备固本、大修、安技措计划编制，设备检修管理，设备故障、事故处理，钢丝绳、皮带、备用件库存、使用及动态状况管理，设备润滑管理。
　　4.各部门之间业务关系图
　　各部门之间业务关系如图2。

图2　各部门之间业务关系图
三、系统设计原则
　　(1)利用现代计算机和通信技术，实现全集团公司机电设备的计算机管理，提高工作质量，规范业务处理，实现信息共享。在代替手工劳动的基础上，使管理部门管理工作提高到一个新的水平。
　　(2)以先进的INTRANET为网络平台，将INTRANET技术和MIS技术有效地结合起来，为管理部门的日常事物处理提供全新的支持。
　　(3)以C/S、B/S交叉并用模式来组织系统的开发，在矿内、局内采用C/S模式，供业务人员使用。C/S模式交互性强，安全性好，网络通讯量低，速度快。在集团公司内采用B/S模式，供领导查询用。B/S模式客户端简化，开发、维护容易，用户操作使用简单，又适用于网上信息发布。
　　(4)提高数据统计分析质量，确保数据查询、统计的准确性和及时性。
　　(5)促进管理和决策科学化与现代化。
　　(6)具有统一、清晰、简洁、直观、真实的图形用户界面，操作简便、使用直观。
　　1.规范业务处理
　　(1)所有机电设备的类别、类型、编号，集团公司所辖所有局矿级单位均实行统一编码，以规范业务管理，该编码由局里统一制定。各矿下属单位可由各矿统一编码。
　　(2)设备编号应尽量符合国家标准，便于设备分类管理，便于设备的查询、统计。设备编码应反映出设备大类、小类、同类设备顺序号、设备所属单位等其它必要的信息。
　　(3)适当调整业务科室的分工，以满足现代化管理要求。
　　2.分布式数据存储
　　车软件是跨局、矿两级使用的，数据录入主要在各矿、厂，局机关主要是数据查询、统计，也有部分修改工作。由于局矿相距较远，通信速率不高，所以本系统数据的合理分布成为软件成功与否的关键因素之一。我们采用的方案是，数据分布存储在各矿服务器上，局机电处服务器存放各矿数据的复本，局矿两级大会数据定期相互复制，以保证局机电处服务器存放各矿最新数据，并将局里对数据的修改及时回送到各矿，以保持数据的一致性。
　　优点：系统运行效率较高，输入、查询响应速度快，局机关查询、统计数据灵活。可在系统空闲时间进行数据复制。
　　缺点：数据冗余较大，查询的数据可能不是最新的。
　　我们在系统维护子系统中给特权用户提供局矿两级传送数据的操作界面，如矿里向局里传送数据，先选定被更新的数据库表名，定义数据倒入的文件名，系统自动利用Oracle的exp73命令，将被更新数据倒出到该文件中(文件扩展名为.dmp)；用户再选定局服务器名，系统自动将该文件利用FTP上载到局服务器，局里的特权用户可在系统维护子系统中选定矿服务器名，倒出数据的文件名，系统自动利用Oracle的imp73命令，将数据从.dmp文件中倒入局数据库相应的表中。如局里修改了数据，也将数据倒出到一.dmp文件中，然后下载到对应的矿服务器上，矿特权用户可将该数据从,dmp文件倒入自己的数据库相应表中。
　　3.系统的灵活性
　　本系统适用局、矿两级使用，根据各部门职能，合理划分功能模块，分别进行开发。使用安装时，可根据业务需要，灵活组合所需的各功能模块。
　　本系统涉及的报表非常多，报表中某些项值的计算算法是动态改变的，一时期和另一时期不同，我们允许用户预先自行定义各种算法。如，先由用户给该算法起个名称，然后，由用户在列与列间选择要进行计算的域名，并列出计算关系，再由用户在行与行间选择要做这种计算的记录，定义记录间要进行的运算，求和或取平均值或求方差或不进行任何计算。统计时，用户只要选好要进行计算的项，选定算法名称，系统则自动按用户定义的算法进行计算。
　　另外，报表的生成也由用户随机选项，表格样式也可由用户在规范的报表格式中选择，表格宽度可由用户任意拖拉决定。解决办法是用程序根据用户的选择定义报表特性描述表文件*.frx，提供给用户的可拖拉控件是Grid控件，打印报表的列宽同Grid表的列宽按一定比例自动调整。
　　4.系统的可维护性
　　对系统中设备类别、类型、单位、地点等均做在系统维护中，日后可由特权用户自行修改维护，因它们均采用统一编码，对其名称的更改并不影响历史数据信息的查询统计。
　　5.系统的安全性
　　本系统登录时要对系统的使用者进行身份识别，然后按所授予的权很对其开放相应的功能。为了保持数据的安全性和可靠性，对数据的读、写、修改权限要分岗位责任明确划分。
　　本系统的用户管理由系统维护模块实现，由该系统的管理员授权，权限首先按功能模块划分，即是否有权进入该模块；其次，进入该模块的用户还分为能进行编辑的特权用户和只能查询的非特权用户。
　　本系统的系统维护中，还包括数据库备份与恢复、数据在局矿两级服务器之间的传送、性能调整等。
　　6.系统的先进性
　　本系统将为领导查询决策提供一定的计算机辅助决策功能。如提升机等四大运转设备的使用期限预警，是由用户事先输入预警条件，每次系统运行起来，自动进行检测，如有预警信息，则通过信号灯闪烁、声音、以及提示信息告警，还可向用户提供工作建议。钢丝绳的更换和供需预警，也可由用户事先设定预警条件，系统自动根据钢丝绳的使用检测记录发出预警提示。用电情况历史同期比较等在统计时也用图形和数据显示等，帮助领导做出决策。
　　7.系统的处理方法流程
　　系统的处理方法流程如图3。

图3 系统的处理方法流程
四、系统的配置及网络结构
　　系统服务器选用UNIX操作系统，网络数据库选用Oracle7.3，工作站操作系统是Windows98，前端开发工具选用Visual Foxfro5.0，网络协议使用TCP/IP，Browse端开发用Front Page 98和VB Script。其系统的网络结构图如图4。

图4　系统的网络结构图
五、系统的总体结构
　　系统的总体结构如图5。



图5 系统的总体结构
　　各子系统功能如下：
　　1.设备资产管理子系统
　　该系统包括设备台帐管理；安技措管理；固本计划管理；大修管理。其中设备台帐管理又分为设备基本信息管理和设备技术特征参数管理。前者对设备基本信息建立档案，系统可按各种方式对某台设备或某类设备的基本信息进行查询和统计，如按设备名称、规格型号或安装地点等特征进行查询。后者建立设备技术特征参数档案，系统具有对技术特征参数档案的建立、编辑、保存、浏览功能。安技措管理是先由各矿编制自己的年度安技措计划，上报到局里，局里对各矿的安技措计划进行审批，并对安技措计划的完成情况进行统计。设备固本计划管理是由各矿编制自己的年度设备购置计划，上报给局里，局里对各矿的设备购置计划进行审批，购置资金超过一定限额时，要进行设备的选型论证，局里还将对固本计划完成情况进行统计查询。设备大修管理是由各矿编制自己的设备大修计划、上报局里，局里对各矿的设备大修计划进行审批，并对大修计划完成情况进行统计和查询。
　　2.运转设备管理子系统
　　该子系统包括带式输送机运输系统管理，钢丝绳管理、停产检修管理和四大主要运转情况管理、技术资料、地面/井下带式输送机布置图管理、使用库存统计汇总。钢丝绳管理包括钢丝绳规格参数据管理、钢丝绳使用动态管理、钢丝绳供需管理、钢丝绳技术理论运算。停产检修管理中，先由各矿编制年度矿产停产检修计划和矿井月停产检修计划，上报局里，局里对各矿的停产检修计划进行审批，并按月统计停产检修计划完成情况。四大主要运转设备的管理包括设备技术档案管理、设备运行动态管理、设备系统事件记录、设备备品备件数据库内容、设备查询指标、设备期限预警及部件使用寿命统计。
　　3.特种设备管理子系统
　　该子系统包括特种设备(起重机，电梯，机动车)安检管理和锅炉、压力容器管理。其中包括特种设备台帐管理、特种设备安全检测记录、锅炉台帐的管理、锅炉事故、修理改造及变更摘记、各矿压力容器检验报告、压力容器技术状态统计表管理。
　　4.设备动态状况管理子系统
　　该系统包括设备当前状态记录；设备事故管理；设备调剂管理；设备报废管理；设备调拨管理；设备库存管理；设备维修管理。
　　5.设备租赁管理子系统
　　该子系统包括闲置可供租赁设备的管理、租赁设备选型、租赁合同管理、租赁设备清单管理、租赁费用帐目管理、租赁单位情况记录、租赁设备基本信息记录、设备租赁情况动态记录。
　　6.设备润滑管理子系统
　　该子系统包括设备规范润滑记录；设备实际润滑检测；设备润滑添加记录；设备润滑更换记录；设备添加剂管理。
　　7.供电系统管理子系统
　　该子系统包括供电系统图的管理；历年重大事故记录分析资料的管理；供电报表管理；合同管理；预防性试验管理；经济活动分析。其中合同管理还包括依据合同完成情况发放奖金的管理。
　　8.文档管理子系统
　　该子系统包括各种文档的录入，各种随机资料关键字的录入，以及各种单据关键字的录入，当需要时，可根据文档、随机资料或单据的时间、名称或关键字查询文档的内容或文档、随机资料或单据的存放位置。
　　9.小电管理子系统
　　对煤矿小型电器设备的管理，具有完善的输入、修改、查询、打印、统计、数据分析、数据维护，系统帮助等功能。
　　10.电缆管理子系统
　　该子系统包括电缆基本信息、技术参数、电缆的动态使用情况管理和电缆当前状态统计。
　　11.统计报表子系统
　　统计报表子系统包括各矿上报的各种重要报表及其俯表，以及局里对这些表的汇总。
　　12.综合查询子系统
　　提供领导通过浏览器可查询到的一些必要的基本和统计的信息。
　　13.系统维护子系统
　　授予用户使用系统的权限。对数据库中的基础数据(如设备编码、设备类型、类别、单位、地点名称及编码)进行维护。允许特权用户备份数据、进行局矿两级传送数据。
六、结束语
　　因系统选用面向对象的程序开发工具，我们做了许多通用的类，如万能查询的条件输入窗口等，到处都可调用它，开发效率高。
　　系统中用了大量的图形来显示统计结果、直观、漂亮，便于领导分析决策。
　　给用户提供的操作界面，尽量让用户去选择，既方便，又保证了数据的完整性和一致性。
　　交叉并用C/S和B/S模式，兼有部分计算机辅助决策功能，灵活的算法、报表生成，强大的系统维护功能支持系统的可维护性，局矿两级分布式数据库MIS的设计不失为本系统的突出特色。■
作者单位：唐枚(西安交通大学 西安 710043)
　　　　　张跃进(西安百联系统工程有限责任公司 西安 710043)
参考文献
［1］曹维远、叶文川　C/S模式和B/S模式交叉并用的MIS系统平台　微计算机应用　1999.3
［2］S.Ceri, G.Pelagutt Distributed Databases: Principles & System
［3］Singh & Leigh等著　史森　夏丽丽译　Oracle数据库开发指南　清华大学出版社　1998.6
收稿日期：1999-07-30
