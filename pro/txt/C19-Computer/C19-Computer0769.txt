自动化学报
ACTA AUTOMATICA SINICA
1999年　第25卷　第5期　Vol.25 No.5 1999



用区域特征进行人面定位的研究1)
徐　宁　吴文胜　杨光正
摘　要　对人面定位中基于镶嵌图的区域特征提取进行了进一步的探讨，提供了一个利用区域特征进行人面自动定位的系统.这个系统是建立在用镶嵌图抽取区域特征的基础上，应用基于知识的模式识别方法构造的一个句法知识系统.系统具有独立的人面定位规则库，取得了较高的正确识别率和效率.同时给出了一些实验结果.
关键词　区域特征，人面定位，镶嵌图，定位规则.
HUMAN FACE LOCATION USING AREA FEATURES
XU Ning　WU Wensheng　YANG Guangzheng
(Dept. of Automation, University of Science & Technology of China, Hefei, Anhui　230027)
Abstract　In this paper, a further study on human face location using area feature is reported. We construct an automatic human face location system based on the area features extracted from mosaic image. This system is a knowledge-based pattern recognition system using syntactic method. An independent location rule base is constructed. High recognition rate and high efficiency are achieved. Some experiment results are given.
Key words　Area feature; human face location; mosaic image; location rules.

1　引　言
　　人面是常见而复杂的模式，其自动识别有广阔的应用前景.近年来，研究人员对人面识别做了大量的工作，但由于其难度很高，这些工作离实用还相差甚远［1］.
　　一个完全自动的人面识别的第一步是要在图片中自动找到可能的人面位置.只有在复杂背景中的人面自动定位得到了解决，才可能实现真正意义上的人面自动识别.人面自动定位应能解决：1)找到人面的位置；2)给出人面的数量；3)决定人面的大小.由于人面定位的实质是把人面区域同图像的其它区域区分开来，通过抽取人面的区域特征来区分人面与背景是一个有效的办法.
　　文献［2］中提出了用镶嵌图抽取区域特征进行人面定位的方法.本文介绍了作者对这个方法的进一步研究结果.作者研究了用镶嵌图抽取区域特征的机理，用五-十分图代替了过去的四-八分图，采用了高效句法分析算法进行搜索，建立了一个基于知识的复杂背景图片人面定位系统，它有独立的定位规则库.文中给出了实验结果.
2　用镶嵌图抽取区域特征
2.1　镶嵌图的构成
　　镶嵌图是将原始图像的解析度有规则地降低得到的图像.它由细胞组成，每个细胞的灰度等于细胞内所有象素的灰度的平均值.若细胞边长为N，细胞内含有N×N个象素，则称该镶嵌图为原始图像的N级镶嵌图.
　　当应用于人面定位时，采用固定大小的正方形考察窗口.设窗口内局部镶嵌图的边长为M个细胞，则称此局部镶嵌图为M分图，它包含M×M个细胞.
　　用不同级别的镶嵌图对人面图片进行考察后发现，当人面在镶嵌图中粗略地显现出来时，它大约占有5×5个细胞.因此，可以对样本集中的已知人面构造具有5×5个细胞的局部的镶嵌图，即五分图，在此基础上建立初步的搜索规则.当镶嵌图中人面明显地表现出来时，人面大约占有10×10个细胞.为此，可以在对样本人面构造十分图的基础上建立较精细的人面搜索用的规则集.
2.2　镶嵌图的性质
　　1)镶嵌图的低解析度特性
　　镶嵌图抽取的信息量比原始图像少得多，有利于区域特征的抽取，并且可以减少计算量，加快计算速度.
　　2)局部镶嵌图规则的尺寸不变性
　　若对两个尺寸大小不同的同一人面分别做五分图和十分图，它们的五分图数据和十分图数据大体上是相同的.因此规则可以不依人面的大小而改变.亦即局部镶嵌图规则具有尺寸不变性.
　　3)局部镶嵌图规则对于坐标变换的稳定性
　　镶嵌图抽取的区域特征，对于窗口的有限平移不太敏感.例如，把一个N级五分图向右平移一个像素，则其每个细胞当中的N(N-1)个像素并未改变，若N=10，即90%的像素灰度并未改变.平移前后的细胞像素灰度值差相对来说是不大的.因此一定范围内平移后的镶嵌图也能使用同样的定位规则来决定人面.从而可以适当加大步长以加快搜索的速度.
　　另外，由于抽取的区域特征对于小范围内的旋转变换和仿射变换不敏感，因此局部镶嵌图在定位人面时允许人面有一定限度的偏斜、倾侧和俯仰.
　　4)局部镶嵌图对噪声的不敏感性
　　局部镶嵌图的每一个细胞的值是细胞内所有像素的平均值，相当于一个平滑，因此可以在一定范围内降低噪声对定位的影响.甚至可以把某些类眼镜看成是噪声，也用五-十分图的人面定位规则进行正确定位.
2.3　定位规则的建立以及人面的搜索过程
　　人面定位的规则可归纳为：1)真正的人面应该满足的规则；2)真正的人面不应该满足的规则.定位结果可能产生两类错误：1)在图像上存在人面的地方没有作出“存在人面”的决策；2)在图像上不存在人面的地方作出“存在人面”的决策.第一类错误将造成人面的遗漏，这在以后的阶段中是无法挽救的.第二类错误会使结果中增加一些虚假人面，这类错误可以在后续阶段中予以纠正.由于本系统是多级的，在建立定位规则时，希望尽量少发生第一类错误，而允许一定数量的第二类错误的存在.
　　按照以上原则，通过对样本图像进行反复实验，得出了一套较为适用的以五分图和十分图为基础的人面定位规则.
　　本系统用镶嵌图进行人面定位的过程分为两个阶段.第一阶段利用五分图规则在输入图像上作全局搜索，找出候选人面.然后用这些候选人面作为第二阶段的输入，利用十分图的规则匹配，得出定位结果.
　　作者在一个很宽的范围之内(N=8-26)分别进行五分图规则的搜索.解决了在一般情况下人面的数量、大小和位置都未知的人面自动定位问题.
3　对以往工作的几点改进
　　较之文献［2］,作者对人面定位方法作了以下改进.
3.1　用五-十分图代替四-八分图
　　五-十分图被用来取代四-八分图以抽取人面定位的规则.理由是：
　　1)由于人面是一个复杂的模式，用四分图不一定能抽取出足够的区域特征.而用五分图则增加了信息量，并且能够把眼区、鼻区、嘴区大致区分开，这有利于定位规则的建立.
　　2)对于人面模式，若分为四列，则多数情况下会把鼻区生硬地分在两列，而采用五分图，鼻区就大致位于中间一列.这样能比较好地抽取有用的特征和建立规则.而在十分图中，鼻区位于中间两列，也容易提取特征.
3.2　基于知识模式识别方法的应用和算法的选取
　　对于复杂的模式识别问题，为了提高识别能力，常常需要用到专家的知识和经验，因而作者采用了基于知识的模式识别方法.众所周知，句法模式识别系统具有专家系统的基本性质［3］，它们之间对应关系如下：


　　可见，句法模式识别的产生式可以有效地表达知识.在这个问题上，文献［3］对过去国外的看法做了纠正，提出了行之有效的知识表达方法.上下文无关文法具有较强的知识表达能力，并存在不少的句法分析算法，Earley算法是其中一种高效算法［4］.作者采用了在Earley算法基础上改进的符合深度优先搜索习惯的ED算法［5］，它具有O(n2)的空间复杂度和O(n3)的时间复杂度.
　　复杂背景中的人面定位问题是一个难度很大的模式识别问题，作者在ED算法的基础上构造句法知识系统，利用区域特征来解决人面定位的问题，取得了较好的结果.
3.3　独立的规则库的建立
　　本系统规则库在系统处于非运行状态时，是以文本方式存放的.这种结构的好处在于它使规则库的建立和维护十分方便，同时在很大程度上保证了句法知识系统各部分的相对独立性，它可以使系统几乎不受规则库的约束.通过更改规则库即可使本系统用于解决其他的模式识别问题.从而使得系统具有一定的通用性.
4　实验结果
　　作者用 100 张图片作为训练集，另外 175 张图片作为考试集.图片中人面的位置和大小是随机的，每张图片中一般包含一张或两张人面.
　　本系统人面定位成功率为91.43%，其中正面人面成功率为92.74%，一定范围内的侧面，倾斜，俯仰的人面成功率为88.23%.第二类错误出现率为22.16%，其中两个或两个以上的第二类错误的出现率为4.54%，最多时出现4个第二类错误.
5　结　论
　　1)区域特征在人面定位中有重要作用.利用镶嵌图建立的规则可以提供一个搜索复杂背景图片中人面位置、数量和大小的有效方法.它为建立完全自动的人面识别系统准备了条件.
　　2)利用五-十分图取代四-八分图进行第一和第二阶段的人面定位是一项有效的改进.
　　3)基于知识的句法模式识别方法的应用把规则和算法独立开来，使得规则的改进和维护变得非常容易.将它与人面定位相结合，使人面定位系统效率大大提高，并为以后的改进提供方便.
1) 国家自然科学基金资助项目(69375002).
作者简介：徐　宁　1975年生.1996年在中国科学技术大学自动化系获得学士学位.同年免试进入中国科大自动化系攻读硕士学位.目前研究领域为模式识别、图像处理、神经网络.
　　　　　吴文胜　1968年生.1996年在中国科学技术大学自动化系获得硕士学位.现在深圳华为技术有限公司工作.目前研究领域为计算机网络、通信技术.
作者单位：中国科学技术大学自动化系　合肥　230027
参考文献
1　Chellappa R, Wilson C L, Sirohey S. Human and machine recognition of faces: a survey. In: Proceedings of the IEEE, 1995, 83:705-740
2　Yang G Z, Huang T S. Human face detection in a complex background. Pattern Recognition, 1994, 27(1):53-63
3　Yang Guangzheng. On the knowledge-based pattern recognition using syntactic approach. Pattern Recognition, 1991, 24(3):185-193
4　Earley J. An efficient context-free parsing algorithm. Commun.ACM., 1970, 13(2):94-102
5　杨光正.一个基于句法方法的搜索策略.模式识别与人工智能91学术会议论文集：610-613，1991
收稿日期：1997-06-09
修稿日期：1998-04-06
