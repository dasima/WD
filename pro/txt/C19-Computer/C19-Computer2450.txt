软件学报
Journal of Software
2000 Vol.11 No.1 P.91-94



多模式下的反合一算法
许锡春　胡运发　施伯乐
摘　要　证明了多模式环境下存在最小反合一,提出了一种反合一算法,并介绍了多模式下反合一的应用.
关键词　合一,反合一,多模式,算法,相似.
中图法分类号　TP301
Anti-Unification Algorithm Based on Multi-Pattern
XU Xi-chun　HU Yun-fa　SHI Bai-le
(Department of Computer Science　Fudan University　Shanghai　200433)
XU Xi-chun
(Computing Center　Shanghai Maritime University　Shanghai　200135)
Abstract　In this paper, the existence of the least anti-unification in multi-pattern is proved and an algorithm for the anti-unification is proposed. In addition, the application of the anti-unification in multi-pattern is also introduced.
Key words　Unification, anti-unification, multi-pattern, algorithm, similarity.
　　合一操作计算的是最大下界,而与合一对应的反合一操作计算的是最小上界.合一操作在定理证明、自动推理等方面起到重要的作用,反合一同样也是一种非常有用的操作,可以应用于类似推理、程序重写、机器学习等方面.这些年来,对反合一的研究正在加强.反合一最早是由Plotkin［1］和Reynolds［2］分别提出来的.与合一一样,反合一也存在各种形式.最近,许多学者对各种形式的反合一进行了研究.Page［3］研究了基于各种约束形式的反合一,基于约束的反合一可以避免过分抽象(overgeneralization).Hasker［4］研究了二阶反合一,提出二阶反合一可以包含更多的信息,但不存在二阶最小反合一,并通过增加限制来保证得到明确的反合一.Pfenning［5］研究了基于类型的、以λ演算为基础的反合一,并提出类型也是一种约束,同样可以避免过分抽象.这些研究都有一个共同的特点：逻辑结构都是在单模式下,即对于谓词P,其模式P(a1,a2,...)是唯一的.但是，在不同的应用中可以有多种模式,例如,在面向对象的系统中允许操作重载；在类似推理中,有时一个问题可以有多种描述形式.当然,也可以用不同的谓词来表示,但是这样做,一方面,其共性不能表示；另一方面,必使谓词数目成倍增加.
　　本文对多模式下的反合一进行了研究,证明了在多模式下存在着最小反合一,并提出了计算最小反合一的算法.
1　基本概念
　　我们把所有变量的集合记为V,常量的集合记为C,类型的集合记为T.在此基础上,我们定义有关概念.
　　定义1. 模式.谓词P的模式为P（x1:t1,x2:t2,...,xn:tn),其中xi为变量,ti为类型.
　　我们采用表达式即类型的思想,把每一谓词也看作类型,即谓词P也称为类型P,并且模式也可以表示为P(t1(x1),t2(x2),...,tn(xn)),因此,模式中的参数也可以是另一模式,类似于关系数据库中的非第一范式.我们可以把（）看作是一种操作.
　　定义2. 多模式.谓词P存在多个模式,其表示可以有以下两种形式：
P(t1(x1),t2(x2),...,tn(xn));
P(t1(x1),t2(x2),...,［ti(xi)］,...,tn(xn)),
其中［ ］表示可选.
　　定义3. 导出模式.假设P的模式为P(t1(x1),t2(x2),...,［ti(xi)］,...,tn(xn)),则P(t1(x1),t2(x2),...,ti(xi),...,tn(xn))和P(t1(x1),t2(x2),...,ti-1(xi-1),ti+1(xi+1),...,tn(xn))都是模式P(t1(x1),t2(x2),...,［ti(xi)］,...,tn(xn))的导出模式.
　　定义4. 模式包含.对于模式P1(x1,x2,...,xn),P2(y1,y2,...,ym),若P1,P2相同,对任何i∈(1,n),存在j∈(1,m),xi=yi,且对于i1<i2,有j1<j2.
　　定义5. 模式的合并.若模式P1(x1,x2,...,xn),P2(y1,y2,...,ym)为P的导出模式,则P1,P2的合并模式P0(z1,z2,...,zn)为P的导出模式中包含模式P1,P2的最小模式.
　　定理1. 模式的合并是唯一的.
　　定义6. 实例.对于模式P中各参数,用相同类型的项代入,即为P的实例.表示空,只能代入可选的参数.
　　定义7. 项.项可以有以下几种形式：(1)为项；(2) 常量为项；(3) 变量为项；(4) 模式P的实例为项. 
2　反合一问题
　　反合一计算的是两个实例的最小上界.为了比较大小,类似于合一运算,可以利用替换来定义一个实例序.
　　定义8. 实例序.对于两个项t,s,若存在替换σ,使得σt=s,则定义实例序为t大于s,记为t≥s.
　　合一采用项来替换变量,得到共同的实例.而与之相反,我们也可以用变量来代替项,得到共同的抽象,这就是反合一.
　　定义9. 反合一.对于两个项t,s,若存在替换σ,θ及项g,使得σg=t,θg=s,则g为t,s的反合一.
　　合一操作一般计算最大的共同实例(基于实例序),同样地,反合一操作一般计算最小反合一.
　　定义10. 最小反合一.若g为t,s的反合一,对于任何t,s的反合一q,有g≤q,则称g为t,s的最小反合一.
　　定义11. 多模式下的反合一.对于谓词P的模式的两个实例t,s,若存在替换σ,θ及P的模式的实例g,使得σg=t,θg=s,则g为t,s在多模式下的反合一.
　　由于P也是一种类型,允许g为P(x),其中x为变量.替换可以有以下几种形式：(1) x→